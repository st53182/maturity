"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[322],{4322:function(e,t,a){a.r(t),a.d(t,{default:function(){return F}});var l=a(6768),s=a(4232),o=a(5130);const i={class:"motivation-container"},r=["onClick"],n=["src"],c={class:"card-header"},m=["onClick"],d={class:"team-name"},u={class:"disc-type"},p={key:0,class:"factors"},h={class:"column"},k={class:"column"},f={class:"form-group"},y=["value"],v={class:"form-group"},L=["disabled"],b={key:0,class:"result-block"},_=["innerHTML"];function C(e,t,a,C,g,x){return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("div",i,[t[11]||(t[11]=(0,l.Lk)("h1",null,"🎯 Мотивация сотрудника",-1)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(g.employees,(e=>((0,l.uX)(),(0,l.CE)("div",{key:e.id,class:"employee-card",onClick:t=>x.selectEmployee(e)},[(0,l.Lk)("img",{class:"avatar",src:x.getAvatarUrl(e.ai_analysis),alt:"avatar"},null,8,n),(0,l.Lk)("div",c,[(0,l.Lk)("h4",null,(0,s.v_)(e.name),1),(0,l.Lk)("button",{onClick:(0,o.D$)((t=>x.deleteEmployee(e.id)),["stop"])},"🗑",8,m)]),(0,l.Lk)("p",d,"Команда: "+(0,s.v_)(x.getTeamName(e.team_id)||"—"),1),(0,l.Lk)("span",u,(0,s.v_)(x.extractDISCType(e.ai_analysis)),1),e.ai_analysis?((0,l.uX)(),(0,l.CE)("div",p,[(0,l.Lk)("div",h,[t[9]||(t[9]=(0,l.Lk)("h5",null,"⬆️ Мотивирующие",-1)),(0,l.Lk)("ul",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(x.extractFactors(e.ai_analysis,"Мотивирующие"),(e=>((0,l.uX)(),(0,l.CE)("li",{key:e},(0,s.v_)(e),1)))),128))])]),(0,l.Lk)("div",k,[t[10]||(t[10]=(0,l.Lk)("h5",null,"⬇️ Демотиваторы",-1)),(0,l.Lk)("ul",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(x.extractFactors(e.ai_analysis,"Демотиваторы"),(e=>((0,l.uX)(),(0,l.CE)("li",{key:e},(0,s.v_)(e),1)))),128))])])])):(0,l.Q3)("",!0)],8,r)))),128))]),(0,l.Lk)("div",{class:"employee-card add-card",onClick:t[0]||(t[0]=(...e)=>x.resetForm&&x.resetForm(...e))},t[12]||(t[12]=[(0,l.Lk)("span",null,"➕",-1),(0,l.Lk)("p",null,"Создать",-1)])),(0,l.Lk)("form",{onSubmit:t[8]||(t[8]=(0,o.D$)(((...e)=>x.submitMotivation&&x.submitMotivation(...e)),["prevent"]))},[(0,l.Lk)("div",f,[t[14]||(t[14]=(0,l.Lk)("label",null,"Имя сотрудника:",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>g.form.name=e),placeholder:"Например: Иван Иванов",required:""},null,512),[[o.Jo,g.form.name]]),t[15]||(t[15]=(0,l.Lk)("label",null,"Должность:",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>g.form.role=e),placeholder:"Например: Аналитик, Разработчик...",required:""},null,512),[[o.Jo,g.form.role]]),t[16]||(t[16]=(0,l.Lk)("label",null,"Команда:",-1)),(0,l.bo)((0,l.Lk)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>g.form.team_id=e),required:""},[t[13]||(t[13]=(0,l.Lk)("option",{disabled:"",value:""},"Выберите команду",-1)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(g.teams,(e=>((0,l.uX)(),(0,l.CE)("option",{key:e.id,value:e.id},(0,s.v_)(e.name),9,y)))),128))],512),[[o.u1,g.form.team_id]])]),(0,l.Lk)("div",v,[t[17]||(t[17]=(0,l.Lk)("label",null,"1. Поведение в стрессовой ситуации",-1)),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":t[4]||(t[4]=e=>g.form.stress=e),placeholder:"Как он реагирует на давление, конфликты...",required:""},null,512),[[o.Jo,g.form.stress]]),t[18]||(t[18]=(0,l.Lk)("label",null,"2. Взаимодействие с другими",-1)),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":t[5]||(t[5]=e=>g.form.communication=e),placeholder:"Открытый, сдержанный, любит работать в команде или один...",required:""},null,512),[[o.Jo,g.form.communication]]),t[19]||(t[19]=(0,l.Lk)("label",null,"3. Особенности в работе",-1)),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":t[6]||(t[6]=e=>g.form.behavior=e),placeholder:"Привычки, подход, структура, планирование...",required:""},null,512),[[o.Jo,g.form.behavior]]),t[20]||(t[20]=(0,l.Lk)("label",null,"4. Реакции на критику и изменения",-1)),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":t[7]||(t[7]=e=>g.form.feedback=e),placeholder:"Как принимает фидбек, открыт к переменам...",required:""},null,512),[[o.Jo,g.form.feedback]])]),(0,l.Lk)("button",{type:"submit",disabled:g.loading},(0,s.v_)(g.loading?"Сохраняем и анализируем...":"Сохранить и получить рекомендации"),9,L)],32),g.result?((0,l.uX)(),(0,l.CE)("div",b,[t[21]||(t[21]=(0,l.Lk)("h2",null,"📋 Рекомендации",-1)),(0,l.Lk)("div",{class:"ai-analysis",innerHTML:g.result},null,8,_)])):(0,l.Q3)("",!0)],64)}a(4114),a(8111),a(2489),a(116),a(1701);var g={data(){return{form:{id:null,name:"",role:"",team_id:"",stress:"",communication:"",behavior:"",feedback:""},teams:[],employees:[],discProfiles:[],result:"",loading:!1}},async mounted(){const e=localStorage.getItem("token"),t=await fetch("/user_teams",{headers:{Authorization:`Bearer ${e}`}});this.teams=await t.json();const a=await fetch("/employees"),l=await a.json(),s=await fetch("/static/disc_profiles_for_frontend.json");this.discProfiles=await s.json(),this.employees=l.map((e=>({...e,motivators:this.extractFactors(e.ai_analysis,"Мотивирующие"),demotivators:this.extractFactors(e.ai_analysis,"Демотиваторы")})))},computed:{motivators(){return this.extractFactors(this.result,"Мотивирующие")},demotivators(){return this.extractFactors(this.result,"Демотиваторы")}},methods:{async submitMotivation(){this.loading=!0;try{const e=await fetch("/motivation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.form)}),t=await e.json();if(e.ok){this.result=t.analysis,this.form.id=t.employee_id;const e=this.employees.findIndex((e=>e.id===t.employee_id)),a={...this.form,id:t.employee_id,ai_analysis:t.analysis,motivators:this.extractFactors(t.analysis,"Мотивирующие"),demotivators:this.extractFactors(t.analysis,"Демотиваторы")};-1!==e?this.employees.splice(e,1,a):this.employees.push(a)}else alert(t.error)}catch(e){alert("Ошибка подключения")}finally{this.loading=!1}},resetForm(){this.form={id:null,name:"",role:"",team_id:"",stress:"",communication:"",behavior:"",feedback:""},this.result=""},async deleteEmployee(e){confirm("Удалить сотрудника?")&&(await fetch(`/employee/${e}`,{method:"DELETE"}),this.employees=this.employees.filter((t=>t.id!==e)))},selectEmployee(e){this.form={id:e.id,name:e.name,role:e.role,team_id:e.team_id,stress:e.stress,communication:e.communication,behavior:e.behavior,feedback:e.feedback},this.result=e.ai_analysis},extractFactors(e,t){if(!e)return[];const a=e.match(new RegExp(`${t}:`,"i"));if(!a)return[];const l=e.indexOf(a[0]),s=e.slice(l),o=/^(Мотивирующие факторы|Демотиваторы|Рекомендации для руководителя):/gim,i=[...s.matchAll(o)];let r=s.length;i.length>1&&(r=i[1].index);const n=s.slice(0,r);return n.split(/[-–•●]/).map((e=>e.trim())).filter((e=>e.length>3))},extractDISCType(e){const t=e?.match(/\*\*Тип DISC:\*\*\s*(.*?)(\*\*|$)/);return t?t[1].trim():"Неизвестно"},getTeamName(e){const t=this.teams.find((t=>t.id===e));return t?t.name:"—"},getAvatarUrl(e){const t=this.extractDISCType(e),a=t?.toLowerCase().split(" ")[0].replace(/[^\w]/g,"");return`/avatars/${a||"default"}.png`}}},x=a(1241);const E=(0,x.A)(g,[["render",C]]);var F=E}}]);
//# sourceMappingURL=322.2e42271f.js.map