"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[760],{760:function(e,t,a){a.r(t),a.d(t,{default:function(){return F}});var o=a(6768),l=a(4232),s=a(5130);const r={class:"motivation-container"},i={class:"employee-list"},n=["onClick"],c=["src"],m={class:"card-header"},u={class:"employee-name"},d=["onClick"],h={class:"team-name"},k={class:"disc-type-full"},p={class:"employee-card-footer"},y=["onClick"],f={key:0,class:"factors"},v={class:"column"},L={class:"column"},b=["innerHTML"],C={key:0,class:"modal-overlay"},g={class:"modal-content"},E=["value"],_=["disabled"],x=["disabled"],A={key:0},w={key:1};function T(e,t,a,T,M,I){return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",r,[t[19]||(t[19]=(0,o.Lk)("h1",null,"üéØ –ú–æ—Ç–∏–≤–∞—Ü–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞",-1)),(0,o.Lk)("div",i,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(M.employees,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"employee-card",onClick:t=>I.selectEmployee(e)},[(0,o.Lk)("img",{class:"avatar",src:I.getAvatarUrl(e.ai_analysis),alt:"avatar",onError:t[0]||(t[0]=(...e)=>I.setDefaultAvatar&&I.setDefaultAvatar(...e))},null,40,c),(0,o.Lk)("div",m,[(0,o.Lk)("h4",u,(0,l.v_)(e.name),1),(0,o.Lk)("button",{class:"delete-btn",onClick:(0,s.D$)((t=>I.deleteEmployee(e.id)),["stop"])},"üóë",8,d)]),(0,o.Lk)("p",h,[t[13]||(t[13]=(0,o.eW)("üè¢ –ö–æ–º–∞–Ω–¥–∞: ")),(0,o.Lk)("strong",null,(0,l.v_)(I.getTeamName(e.team_id)||"‚Äî"),1)]),(0,o.Lk)("p",k,[t[14]||(t[14]=(0,o.eW)("üß† –¢–∏–ø DISC: ")),(0,o.Lk)("strong",null,(0,l.v_)(I.extractDISCFullType(e.ai_analysis)),1)]),(0,o.Lk)("div",p,[(0,o.Lk)("button",{class:"update-btn",onClick:t=>I.handleEmployeeClick(e)}," üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ ",8,y)]),e.ai_analysis?((0,o.uX)(),(0,o.CE)("div",f,[(0,o.Lk)("div",v,[t[15]||(t[15]=(0,o.Lk)("h5",null,"‚¨ÜÔ∏è –ú–æ—Ç–∏–≤–∞—Ç–æ—Ä—ã",-1)),(0,o.Lk)("ul",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.motivators,(e=>((0,o.uX)(),(0,o.CE)("li",{key:e},(0,l.v_)(e),1)))),128))])]),(0,o.Lk)("div",L,[t[16]||(t[16]=(0,o.Lk)("h5",null,"‚¨áÔ∏è –î–µ–º–æ—Ç–∏–≤–∞—Ç–æ—Ä—ã",-1)),(0,o.Lk)("ul",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.demotivators,(e=>((0,o.uX)(),(0,o.CE)("li",{key:e},(0,l.v_)(e),1)))),128))])])])):(0,o.Q3)("",!0),e.ai_analysis?((0,o.uX)(),(0,o.CE)("div",{key:1,class:"manager-tips-block",innerHTML:I.extractManagerTips(e.ai_analysis)},null,8,b)):(0,o.Q3)("",!0),t[17]||(t[17]=(0,o.Lk)("div",{class:"form-footer"},null,-1))],8,n)))),128)),(0,o.Lk)("div",{class:"employee-card add-card",onClick:t[1]||(t[1]=(...e)=>I.resetForm&&I.resetForm(...e))},t[18]||(t[18]=[(0,o.Lk)("span",null,"‚ûï",-1),(0,o.Lk)("p",null,"–°–æ–∑–¥–∞—Ç—å",-1)]))])]),M.showModal?((0,o.uX)(),(0,o.CE)("div",C,[(0,o.Lk)("div",g,[(0,o.Lk)("button",{class:"modal-close",onClick:t[2]||(t[2]=e=>M.showModal=!1)},"‚úñ"),(0,o.Lk)("form",{onSubmit:t[12]||(t[12]=(0,s.D$)(((...e)=>I.submitMotivation&&I.submitMotivation(...e)),["prevent"])),class:"form-group"},[t[21]||(t[21]=(0,o.Lk)("h2",{style:{"text-align":"center"}},"–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–µ",-1)),t[22]||(t[22]=(0,o.Lk)("label",null,"–ò–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞:",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>M.form.name=e),required:""},null,512),[[s.Jo,M.form.name]]),t[23]||(t[23]=(0,o.Lk)("label",null,"–î–æ–ª–∂–Ω–æ—Å—Ç—å:",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>M.form.role=e),required:""},null,512),[[s.Jo,M.form.role]]),t[24]||(t[24]=(0,o.Lk)("label",null,"–ö–æ–º–∞–Ω–¥–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):",-1)),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>M.form.team_id=e)},[t[20]||(t[20]=(0,o.Lk)("option",{value:""},"‚Äî –ë–µ–∑ –∫–æ–º–∞–Ω–¥—ã ‚Äî",-1)),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(M.teams,(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.id,value:e.id},(0,l.v_)(e.name),9,E)))),128))],512),[[s.u1,M.form.team_id]]),t[25]||(t[25]=(0,o.Lk)("label",null,"1. –ü–æ–≤–µ–¥–µ–Ω–∏–µ –≤ —Å—Ç—Ä–µ—Å—Å–æ–≤–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏",-1)),(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":t[6]||(t[6]=e=>M.form.stress=e),required:""},null,512),[[s.Jo,M.form.stress]]),t[26]||(t[26]=(0,o.Lk)("label",null,"2. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –¥—Ä—É–≥–∏–º–∏",-1)),(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":t[7]||(t[7]=e=>M.form.communication=e),required:""},null,512),[[s.Jo,M.form.communication]]),t[27]||(t[27]=(0,o.Lk)("label",null,"3. –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤ —Ä–∞–±–æ—Ç–µ",-1)),(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":t[8]||(t[8]=e=>M.form.behavior=e),required:""},null,512),[[s.Jo,M.form.behavior]]),t[28]||(t[28]=(0,o.Lk)("label",null,"4. –†–µ–∞–∫—Ü–∏–∏ –Ω–∞ –∫—Ä–∏—Ç–∏–∫—É –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è",-1)),(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":t[9]||(t[9]=e=>M.form.feedback=e),required:""},null,512),[[s.Jo,M.form.feedback]]),(0,o.Lk)("button",{onClick:t[10]||(t[10]=e=>I.submitMotivation(!1)),disabled:M.loading}," üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ",8,_),(0,o.Lk)("button",{onClick:t[11]||(t[11]=e=>I.submitMotivation(!0)),disabled:M.loading},[M.loading?((0,o.uX)(),(0,o.CE)("span",A,"‚è≥ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è...")):((0,o.uX)(),(0,o.CE)("span",w,"üí¨ –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏"))],8,x)],32)])])):(0,o.Q3)("",!0)],64)}a(4114),a(8111),a(2489),a(116),a(1701);var M={data(){return{form:{id:null,name:"",role:"",team_id:"",stress:"",communication:"",behavior:"",feedback:""},teams:[],employees:[],result:"",loading:!1,showModal:!1,avatar:"default.png"}},async mounted(){const e=localStorage.getItem("token");try{const t=await fetch("/user_teams",{headers:{Authorization:`Bearer ${e}`}});this.teams=await t.json();const a=await fetch("/employees",{headers:{Authorization:`Bearer ${e}`}}),o=await a.json();if(!Array.isArray(o))return void console.error("–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –Ω–µ –ø–æ–ª—É—á–µ–Ω—ã:",o);this.employees=o.map((e=>({...e,motivators:this.extractFactors(e.ai_analysis,"–ú–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–µ"),demotivators:this.extractFactors(e.ai_analysis,"–î–µ–º–æ—Ç–∏–≤–∞—Ç–æ—Ä—ã"),managerTips:this.extractManagerTips(e.ai_analysis)})))}catch(t){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ:",t)}},methods:{async submitMotivation(e=!1){this.loading=!0;const t=localStorage.getItem("token"),a=e?"/motivation":"/employees",o="POST";try{const e=await fetch(a,{method:o,headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({...this.form,id:this.form.id,team_id:this.form.team_id||null})}),l=await e.json();if(e.ok){this.result=l.analysis||l.message,this.form.id=l.employee_id||l.id;const e={...this.form,id:this.form.id,ai_analysis:l.analysis||"",motivators:this.extractFactors(l.analysis,"–ú–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–µ"),demotivators:this.extractFactors(l.analysis,"–î–µ–º–æ—Ç–∏–≤–∞—Ç–æ—Ä—ã"),managerTips:this.extractManagerTips(l.analysis)},t=this.employees.findIndex((e=>e.id===this.form.id));-1!==t?this.employees.splice(t,1,e):this.employees.push(e),this.showModal=!1,setTimeout((()=>{location.reload()}),300)}else alert(l.error||"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è")}catch(l){console.error(l),alert("–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è")}finally{this.loading=!1}},resetForm(){this.form={id:null,name:"",role:"",team_id:"",stress:"",communication:"",behavior:"",feedback:""},this.result="",this.showModal=!0},async deleteEmployee(e){const t=localStorage.getItem("token");if(confirm("–£–¥–∞–ª–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞?"))try{await fetch(`/employee/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${t}`}}),this.employees=this.employees.filter((t=>t.id!==e))}catch(a){console.error("–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è",a)}},handleEmployeeClick(e){this.selectEmployee(e),this.showModal=!0},selectEmployee(e){this.form={...e},this.result=e.ai_analysis},extractDISCFullType(e){if(!e)return"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ";const t=e.match(/–¢–∏–ø DISC[:-]?\s*<\/?strong>?[\s"]*([A-Z–ê-–Ø]\s*\([^)]+?\))/i)||e.match(/–¢–∏–ø DISC[:-]?\s*([A-Z–ê-–Ø]\s*\([^)]+?\))/i);return t?t[1].trim():"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"},extractFactors(e,t){if(!e)return[];const a=document.createElement("div");a.innerHTML=e;const o=Array.from(a.querySelectorAll("h3, h4, strong")),l=o.find((e=>e.textContent.toLowerCase().includes(t.toLowerCase())));if(!l)return[];const s=l.nextElementSibling;return s&&"UL"===s.tagName?Array.from(s.querySelectorAll("li")).map((e=>e.textContent.trim())):[]},extractDISCType(e){if(!e)return"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ";const t=e.match(/–¢–∏–ø DISC[:-]?\s*<\/?strong>?[\s"]*([A-Z–ê-–Ø][^)<\n:]*\([A-Z–ê-–Ø]\))/i)||e.match(/—Ç–∏–ø\s+[A-Z–ê-–Ø]\s*\([^)]+\)/i)||e.match(/—Ç–∏–ø\s+["¬´]?(.)["¬ª]?/i);return t?t[1].trim():"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"},extractManagerTips(e){if(!e)return"";const t=e.match(/<h3>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è:.*?<\/ul>/is);return t?t[0]:""},getTeamName(e){const t=this.teams.find((t=>t.id===e));return t?t.name:"‚Äî"},getAvatarUrl(e){const t=this.extractDISCType(e),a=t?.toLowerCase().split(" ")[0].replace(/[^\w]/g,"");return`/avatars/${a||"default"}.png`},setDefaultAvatar(e){e.target.src="/avatars/default.png"}}},I=a(1241);const S=(0,I.A)(M,[["render",T],["__scopeId","data-v-1ec9ec86"]]);var F=S}}]);
//# sourceMappingURL=760.33691e57.js.map