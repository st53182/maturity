"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[902],{7902:function(t,e,a){a.r(e),a.d(e,{default:function(){return E}});var o=a(6768),n=a(4232),s=a(5130);const i={class:"conflict-container"},l={class:"filter-bar"},r=["onClick"],c={class:"conflict-list"},u={key:0,class:"summary-block"},f=["innerHTML"],d=["onClick"],p=["onClick"],h={key:0,class:"modal-overlay"},m={class:"modal-content"},k=["innerHTML"],y=["value"],g={class:"modal-actions"},v=["disabled"],C=["disabled"],L=["innerHTML"];function b(t,e,a,b,w,_){return(0,o.uX)(),(0,o.CE)("div",i,[e[17]||(e[17]=(0,o.Lk)("h1",null,"üî• –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∏ –ü—Ä–æ–±–ª–µ–º—ã",-1)),(0,o.Lk)("div",l,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(w.statuses,(t=>((0,o.uX)(),(0,o.CE)("button",{key:t,class:(0,n.C4)({active:w.filterStatus===t}),onClick:e=>w.filterStatus=t},(0,n.v_)(t),11,r)))),128)),(0,o.Lk)("button",{onClick:e[0]||(e[0]=t=>_.openModal(null)),class:"add-btn"},"‚ûï –ù–æ–≤—ã–π –∫–æ–Ω—Ñ–ª–∏–∫—Ç")]),(0,o.Lk)("div",c,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(_.filteredConflicts,(t=>((0,o.uX)(),(0,o.CE)("div",{key:t.id,class:"conflict-card"},[(0,o.Lk)("h3",null,"üß† "+(0,n.v_)(t.context.slice(0,100))+"...",1),(0,o.Lk)("p",null,"üë• –£—á–∞—Å—Ç–Ω–∏–∫–∏: "+(0,n.v_)(_.getParticipantNames(t.participants)),1),(0,o.Lk)("p",null,"üéØ –¶–µ–ª—å: "+(0,n.v_)(t.goal),1),(0,o.Lk)("p",null,[e[9]||(e[9]=(0,o.eW)("üìå –°—Ç–∞—Ç—É—Å: ")),(0,o.Lk)("strong",null,(0,n.v_)(t.status),1)]),t.ai_analysis?((0,o.uX)(),(0,o.CE)("div",u,[e[10]||(e[10]=(0,o.Lk)("strong",null,"üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:",-1)),(0,o.Lk)("p",{innerHTML:_.shortenAnalysis(t.ai_analysis)},null,8,f)])):(0,o.Q3)("",!0),(0,o.Lk)("button",{onClick:e=>_.openModal(t)},"‚úèÔ∏è –û—Ç–∫—Ä—ã—Ç—å –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å ",8,d),(0,o.Lk)("button",{class:"delete-btn",onClick:e=>_.deleteConflict(t.id)},"üóë",8,p)])))),128))]),w.showModal?((0,o.uX)(),(0,o.CE)("div",h,[(0,o.Lk)("div",m,[w.form.ai_response?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"ai-analysis",innerHTML:w.form.ai_response},null,8,k)):(0,o.Q3)("",!0),(0,o.Lk)("h2",null,(0,n.v_)(w.form.id?"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å":"–ù–æ–≤—ã–π –∫–æ–Ω—Ñ–ª–∏–∫—Ç"),1),e[12]||(e[12]=(0,o.Lk)("label",null,"–ö–æ–Ω—Ç–µ–∫—Å—Ç",-1)),(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":e[1]||(e[1]=t=>w.form.context=t),rows:"3",placeholder:"–û–ø–∏—à–∏—Ç–µ —Å—É—Ç—å —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–∞–∫ –æ–Ω–∞ –≤–æ–∑–Ω–∏–∫–ª–∞, —á–µ–º –¥–µ—Ç–∞–ª—å–Ω–µ–µ —Ç–µ–º –ª—É—á—à–µ..."},null,512),[[s.Jo,w.form.context]]),e[13]||(e[13]=(0,o.Lk)("label",null,"–£—á–∞—Å—Ç–Ω–∏–∫–∏ (–¥–ª—è –≤—ã–±–æ—Ä–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ ctrl) / –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ ",-1)),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>w.form.participants=t),multiple:""},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(w.employees,(t=>((0,o.uX)(),(0,o.CE)("option",{value:t.id,key:t.id},(0,n.v_)(t.name),9,y)))),128))],512),[[s.u1,w.form.participants]]),e[14]||(e[14]=(0,o.Lk)("label",null,"–ß—Ç–æ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞–ª–æ—Å—å?",-1)),(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":e[3]||(e[3]=t=>w.form.actions_taken=t),rows:"3",placeholder:"–ö–∞–∫–∏–µ —à–∞–≥–∏ —É–∂–µ –±—ã–ª–∏ –ø—Ä–µ–¥–ø—Ä–∏–Ω—è—Ç—ã –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è?"},null,512),[[s.Jo,w.form.actions_taken]]),e[15]||(e[15]=(0,o.Lk)("label",null,"–¶–µ–ª—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è",-1)),(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":e[4]||(e[4]=t=>w.form.goal=t),rows:"3",placeholder:"–ö–∞–∫–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤—ã —Ö–æ—Ç–∏—Ç–µ –¥–æ—Å—Ç–∏—á—å?"},null,512),[[s.Jo,w.form.goal]]),e[16]||(e[16]=(0,o.Lk)("label",null,"–°—Ç–∞—Ç—É—Å",-1)),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":e[5]||(e[5]=t=>w.form.status=t)},e[11]||(e[11]=[(0,o.Lk)("option",{value:"–ê–∫—Ç–∏–≤–µ–Ω"},"–ê–∫—Ç–∏–≤–µ–Ω",-1),(0,o.Lk)("option",{value:"–ó–∞–∫—Ä—ã—Ç"},"–ó–∞–∫—Ä—ã—Ç",-1),(0,o.Lk)("option",{value:"–û–±–æ—Å—Ç—Ä–µ–Ω–∏–µ"},"–û–±–æ—Å—Ç—Ä–µ–Ω–∏–µ",-1)]),512),[[s.u1,w.form.status]]),(0,o.Lk)("div",g,[(0,o.Lk)("button",{class:"generate-btn",onClick:e[6]||(e[6]=(...t)=>_.submitConflict&&_.submitConflict(...t)),disabled:w.loading}," üí¨ "+(0,n.v_)(w.loading?"–ì–µ–Ω–µ—Ä–∞—Ü–∏—è...":"–ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏"),9,v),w.form.id?((0,o.uX)(),(0,o.CE)("button",{key:0,class:"save-btn",onClick:e[7]||(e[7]=(...t)=>_.saveConflict&&_.saveConflict(...t)),disabled:w.saving}," üíæ "+(0,n.v_)(w.saving?"–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...":"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –∑–∞–∫—Ä—ã—Ç—å"),9,C)):(0,o.Q3)("",!0),(0,o.Lk)("button",{class:"modal-close",onClick:e[8]||(e[8]=t=>w.showModal=!1)},"‚úñ")]),w.form.ai_response?((0,o.uX)(),(0,o.CE)("div",{key:1,class:"ai-analysis",innerHTML:w.form.ai_response},null,8,L)):(0,o.Q3)("",!0)])])):(0,o.Q3)("",!0)])}a(4114),a(8111),a(2489),a(1701);var w={data(){return{conflicts:[],employees:[],showModal:!1,saving:!1,loading:!1,filterStatus:"–í—Å–µ",statuses:["–í—Å–µ","–ê–∫—Ç–∏–≤–µ–Ω","–ó–∞–∫—Ä—ã—Ç","–û–±–æ—Å—Ç—Ä–µ–Ω–∏–µ"],form:{id:null,context:"",participants:[],actions_taken:"",goal:"",status:"–ê–∫—Ç–∏–≤–µ–Ω",ai_response:""}}},computed:{filteredConflicts(){return"–í—Å–µ"===this.filterStatus?this.conflicts:this.conflicts.filter((t=>t.status===this.filterStatus))}},methods:{async fetchConflicts(){const t=localStorage.getItem("token");try{const e=await fetch("/api/conflicts",{headers:{Authorization:`Bearer ${t}`}}),a=e.headers.get("content-type");if(!e.ok||!a?.includes("application/json"))return void console.error("–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤:",await e.text());this.conflicts=await e.json()}catch(e){console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤:",e)}},async fetchEmployees(){const t=localStorage.getItem("token");try{const e=await fetch("/employees",{headers:{Authorization:`Bearer ${t}`}}),a=e.headers.get("content-type");if(!e.ok||!a?.includes("application/json"))return void console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤:",await e.text());this.employees=await e.json()}catch(e){console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤:",e)}},shortenAnalysis(t){const e=t.replace(/<[^>]+>/g,"");return e.slice(0,350)+"..."},getParticipantNames(t){try{const e=Array.isArray(t)?t:JSON.parse(t);return this.employees.filter((t=>e.includes(t.id))).map((t=>t.name)).join(", ")}catch(e){return"‚Äî"}},openModal(t){if(t){this.form={...t};try{this.form.participants=JSON.parse(t.participants||"[]")}catch{this.form.participants=[]}this.form.ai_response=t.ai_analysis||"",this.form.actions_taken=t.attempts||""}else this.form={id:null,context:"",participants:[],actions_taken:"",goal:"",status:"–ê–∫—Ç–∏–≤–µ–Ω",ai_response:""};this.showModal=!0},async deleteConflict(t){const e=localStorage.getItem("token");try{await fetch(`/api/conflict/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${e}`}}),await this.fetchConflicts()}catch(a){alert("–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è"),console.error(a)}},async submitConflict(){this.loading=!0;const t=localStorage.getItem("token"),e={...this.form,participants:JSON.stringify(this.form.participants),attempts:this.form.actions_taken};delete e.actions_taken;const a=!!this.form.id,o=a?`/api/conflict/${this.form.id}`:"/api/conflicts",n=a?"PUT":"POST";try{const a=await fetch(o,{method:n,headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(e)}),s=await a.json();a.ok?(this.form.ai_response=s.analysis,await this.fetchConflicts()):alert(s.error||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞")}catch(s){console.error(s),alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏.")}finally{this.loading=!1}},async saveConflict(){this.saving=!0;const t=localStorage.getItem("token"),e={...this.form,participants:JSON.stringify(this.form.participants),attempts:this.form.actions_taken};delete e.actions_taken;try{const a=await fetch("/api/conflicts/save",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(e)}),o=await a.json();a.ok?(this.showModal=!1,await this.fetchConflicts()):alert(o.error||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏")}catch(a){alert("–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è"),console.error(a)}finally{this.saving=!1}},async waitForTokenAndInit(){let t=10;while(!localStorage.getItem("token")&&t>0)await new Promise((t=>setTimeout(t,300))),t--;const e=localStorage.getItem("token");e?(await this.fetchConflicts(),await this.fetchEmployees()):this.$router.push("/login")}},mounted(){this.waitForTokenAndInit()}},_=a(1241);const S=(0,_.A)(w,[["render",b],["__scopeId","data-v-6f6fb9c5"]]);var E=S}}]);
//# sourceMappingURL=902.18f7720e.js.map