"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[564],{4564:function(e,s,t){t.r(s),t.d(s,{default:function(){return pe}});var i=t(6768),n=t(4232),l=t(5130);const a={class:"surveys-container"},o={class:"create-survey-section"},r={class:"survey-type-selection"},u={key:0,class:"survey-form"},d=["placeholder"],c={value:""},v=["value"],y={value:""},p=["value"],h=["placeholder"],k=["disabled"],m=["disabled"],L={class:"existing-surveys"},g={key:0,class:"loading"},Q={key:1,class:"no-surveys"},w={key:2,class:"surveys-grid"},_={class:"survey-header"},E={class:"survey-type"},C={class:"survey-stats"},b={class:"survey-actions"},q=["onClick"],$=["onClick"],T={key:0,class:"preview-modal"},f={class:"preview-content"},S={class:"preview-header"},X={class:"preview-body"},x={class:"survey-info"},I={key:0},A={key:1},P={key:2},U={class:"questions-preview"},M={class:"question-header"},V={class:"question-number"},F={class:"question-text"},J={key:0,class:"required-mark"},O=["onClick"],K={class:"question-type-info"},N={class:"question-type"},z={key:0,class:"options-count"},B={key:1,class:"scale-info"},R={key:2,class:"matrix-info"},W={class:"email-preview"},D={class:"email-list"},H={class:"recipient-count"},j={class:"preview-actions"},G={key:1,class:"question-edit-modal"},Y={class:"question-edit-content"},Z={class:"edit-header"},ee={class:"edit-body"},se={class:"form-group"},te={class:"form-group"},ie={key:0,class:"form-group"},ne=["onUpdate:modelValue"],le=["onClick"],ae={key:1,class:"form-group"},oe={class:"scale-inputs"},re={class:"edit-actions"};function ue(e,s,t,ue,de,ce){return(0,i.uX)(),(0,i.CE)("div",a,[(0,i.Lk)("h1",null,"📋 "+(0,n.v_)(e.$t("surveys.title")),1),(0,i.Lk)("div",o,[(0,i.Lk)("h2",null,(0,n.v_)(e.$t("surveys.createSurvey")),1),(0,i.Lk)("div",r,[(0,i.Lk)("div",{class:(0,n.C4)(["survey-type-card",{active:"enps"===de.selectedType}]),onClick:s[0]||(s[0]=e=>de.selectedType="enps")},[(0,i.Lk)("h3",null,"📊 "+(0,n.v_)(e.$t("surveys.enpsTitle")),1),s[19]||(s[19]=(0,i.Lk)("p",null,"Собрать обратную связь от сотрудников о текущем состоянии в команде",-1))],2),(0,i.Lk)("div",{class:(0,n.C4)(["survey-type-card",{active:"360"===de.selectedType}]),onClick:s[1]||(s[1]=e=>de.selectedType="360")},[(0,i.Lk)("h3",null,"🔄 "+(0,n.v_)(e.$t("surveys.feedback360Title")),1),s[20]||(s[20]=(0,i.Lk)("p",null,"Собрать анонимную обратную связь о конкретном сотруднике от коллег",-1))],2)]),de.selectedType?((0,i.uX)(),(0,i.CE)("div",u,[(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>de.surveyTitle=e),placeholder:e.$t("surveys.surveyTitle"),class:"survey-input"},null,8,d),[[l.Jo,de.surveyTitle]]),"enps"===de.selectedType?(0,i.bo)(((0,i.uX)(),(0,i.CE)("select",{key:0,"onUpdate:modelValue":s[3]||(s[3]=e=>de.selectedTeamId=e),class:"survey-select"},[(0,i.Lk)("option",c,(0,n.v_)(e.$t("surveys.selectTeam")),1),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(de.teams,(e=>((0,i.uX)(),(0,i.CE)("option",{key:e.id,value:e.id},(0,n.v_)(e.name),9,v)))),128))],512)),[[l.u1,de.selectedTeamId]]):(0,i.Q3)("",!0),"360"===de.selectedType?(0,i.bo)(((0,i.uX)(),(0,i.CE)("select",{key:1,"onUpdate:modelValue":s[4]||(s[4]=e=>de.selectedEmployeeId=e),class:"survey-select"},[(0,i.Lk)("option",y,(0,n.v_)(e.$t("surveys.selectEmployee")),1),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(de.employees,(e=>((0,i.uX)(),(0,i.CE)("option",{key:e.id,value:e.id},(0,n.v_)(e.name),9,p)))),128))],512)),[[l.u1,de.selectedEmployeeId]]):(0,i.Q3)("",!0),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":s[5]||(s[5]=e=>de.emailList=e),placeholder:e.$t("surveys.emailPlaceholder"),class:"survey-textarea",rows:"3"},null,8,h),[[l.Jo,de.emailList]]),(0,i.Lk)("button",{onClick:s[6]||(s[6]=(...e)=>ce.previewSurvey&&ce.previewSurvey(...e)),disabled:!ce.canPreviewSurvey,class:"preview-survey-btn"},(0,n.v_)(e.$t("surveys.previewSurvey")),9,k),(0,i.Lk)("button",{onClick:s[7]||(s[7]=(...e)=>ce.createAndSendSurvey&&ce.createAndSendSurvey(...e)),disabled:!ce.canPreviewSurvey,class:"create-survey-btn"},(0,n.v_)(e.$t("surveys.createAndSend")),9,m)])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",L,[s[21]||(s[21]=(0,i.Lk)("h2",null,"Мои опросники",-1)),de.loading?((0,i.uX)(),(0,i.CE)("div",g,"⏳ Загрузка...")):0===de.surveys.length?((0,i.uX)(),(0,i.CE)("div",Q," Нет созданных опросников ")):((0,i.uX)(),(0,i.CE)("div",w,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(de.surveys,(s=>((0,i.uX)(),(0,i.CE)("div",{key:s.id,class:"survey-card"},[(0,i.Lk)("div",_,[(0,i.Lk)("h3",null,(0,n.v_)(s.title),1),(0,i.Lk)("span",E,(0,n.v_)(s.survey_type.toUpperCase()),1)]),(0,i.Lk)("div",C,[(0,i.Lk)("span",null,(0,n.v_)(e.$t("surveys.responses"))+": "+(0,n.v_)(s.response_count),1),(0,i.Lk)("span",{class:(0,n.C4)(["survey-status",s.status])},(0,n.v_)(e.$t(`surveys.surveyStatus.${s.status}`)),3)]),(0,i.Lk)("div",b,[(0,i.Lk)("button",{onClick:e=>ce.viewResults(s.id),class:"view-results-btn"}," 📊 "+(0,n.v_)(e.$t("surveys.analytics")),9,q),(0,i.Lk)("button",{onClick:e=>ce.copySurveyLink(s),class:"copy-link-btn"}," 🔗 "+(0,n.v_)(e.$t("surveys.copyLink")),9,$)])])))),128))]))]),de.showPreview?((0,i.uX)(),(0,i.CE)("div",T,[(0,i.Lk)("div",f,[(0,i.Lk)("div",S,[(0,i.Lk)("h2",null,(0,n.v_)(e.$t("surveys.previewTitle"))+": "+(0,n.v_)(de.surveyTitle),1),(0,i.Lk)("button",{onClick:s[8]||(s[8]=(...e)=>ce.closePreview&&ce.closePreview(...e)),class:"close-btn"},"✕")]),(0,i.Lk)("div",X,[(0,i.Lk)("div",x,[(0,i.Lk)("p",null,[(0,i.Lk)("strong",null,(0,n.v_)(e.$t("surveys.surveyType"))+":",1),(0,i.eW)(" "+(0,n.v_)(de.selectedType.toUpperCase()),1)]),"enps"===de.selectedType?((0,i.uX)(),(0,i.CE)("p",I,[(0,i.Lk)("strong",null,(0,n.v_)(e.$t("surveys.team"))+":",1),(0,i.eW)(" "+(0,n.v_)(ce.getTeamName(de.selectedTeamId)),1)])):(0,i.Q3)("",!0),"360"===de.selectedType?((0,i.uX)(),(0,i.CE)("p",A,[(0,i.Lk)("strong",null,(0,n.v_)(e.$t("surveys.employee"))+":",1),(0,i.eW)(" "+(0,n.v_)(ce.getEmployeeName(de.selectedEmployeeId)),1)])):(0,i.Q3)("",!0),de.deadline?((0,i.uX)(),(0,i.CE)("p",P,[(0,i.Lk)("strong",null,(0,n.v_)(e.$t("surveys.deadlineLabel"))+":",1),(0,i.eW)(" "+(0,n.v_)(ce.formatDeadline(de.deadline)),1)])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",U,[(0,i.Lk)("h3",null,(0,n.v_)(e.$t("surveys.questionsPreview")),1),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(de.currentQuestions,((s,t)=>((0,i.uX)(),(0,i.CE)("div",{key:s.id,class:"question-preview"},[(0,i.Lk)("div",M,[(0,i.Lk)("span",V,(0,n.v_)(t+1)+".",1),(0,i.Lk)("span",F,(0,n.v_)(s.question),1),s.required?((0,i.uX)(),(0,i.CE)("span",J,"*")):(0,i.Q3)("",!0),(0,i.Lk)("button",{onClick:e=>ce.editQuestion(t),class:"edit-question-btn"},"✏️",8,O)]),(0,i.Lk)("div",K,[(0,i.Lk)("span",N,(0,n.v_)(e.$t(`surveys.questionTypes.${s.type}`)),1),s.options?((0,i.uX)(),(0,i.CE)("span",z," ("+(0,n.v_)(s.options.length)+" "+(0,n.v_)(e.$t("surveys.options"))+") ",1)):(0,i.Q3)("",!0),s.scale?((0,i.uX)(),(0,i.CE)("span",B," ("+(0,n.v_)(e.$t("surveys.scale"))+": "+(0,n.v_)(s.scale[0])+"-"+(0,n.v_)(s.scale[s.scale.length-1])+") ",1)):(0,i.Q3)("",!0),s.rows?((0,i.uX)(),(0,i.CE)("span",R," ("+(0,n.v_)(s.rows.length)+" "+(0,n.v_)(e.$t("surveys.competencies"))+") ",1)):(0,i.Q3)("",!0)])])))),128))]),(0,i.Lk)("div",W,[(0,i.Lk)("h3",null,(0,n.v_)(e.$t("surveys.recipientsPreview")),1),(0,i.Lk)("div",D,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(ce.emailArray,(e=>((0,i.uX)(),(0,i.CE)("span",{key:e,class:"email-tag"},(0,n.v_)(e),1)))),128))]),(0,i.Lk)("p",H,(0,n.v_)(e.$t("surveys.totalRecipients"))+": "+(0,n.v_)(ce.emailArray.length),1)])]),(0,i.Lk)("div",j,[(0,i.Lk)("button",{onClick:s[9]||(s[9]=(...e)=>ce.editSurvey&&ce.editSurvey(...e)),class:"edit-btn"},(0,n.v_)(e.$t("surveys.editSurvey")),1),(0,i.Lk)("button",{onClick:s[10]||(s[10]=(...e)=>ce.createAndSendSurvey&&ce.createAndSendSurvey(...e)),class:"send-btn"},(0,n.v_)(e.$t("surveys.createAndSend")),1)])])])):(0,i.Q3)("",!0),de.showQuestionEdit?((0,i.uX)(),(0,i.CE)("div",G,[(0,i.Lk)("div",Y,[(0,i.Lk)("div",Z,[(0,i.Lk)("h3",null,(0,n.v_)(e.$t("surveys.editQuestion")),1),(0,i.Lk)("button",{onClick:s[11]||(s[11]=(...e)=>ce.closeQuestionEdit&&ce.closeQuestionEdit(...e)),class:"close-btn"},"✕")]),(0,i.Lk)("div",ee,[(0,i.Lk)("div",se,[(0,i.Lk)("label",null,(0,n.v_)(e.$t("surveys.questionText")),1),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":s[12]||(s[12]=e=>de.editingQuestion.question=e),class:"question-input",rows:"3"},null,512),[[l.Jo,de.editingQuestion.question]])]),(0,i.Lk)("div",te,[(0,i.Lk)("label",null,[(0,i.bo)((0,i.Lk)("input",{type:"checkbox","onUpdate:modelValue":s[13]||(s[13]=e=>de.editingQuestion.required=e)},null,512),[[l.lH,de.editingQuestion.required]]),(0,i.eW)(" "+(0,n.v_)(e.$t("surveys.requiredQuestion")),1)])]),"radio"===de.editingQuestion.type?((0,i.uX)(),(0,i.CE)("div",ie,[(0,i.Lk)("label",null,(0,n.v_)(e.$t("surveys.options")),1),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(de.editingQuestion.options,((e,s)=>((0,i.uX)(),(0,i.CE)("div",{key:s,class:"option-input"},[(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":e=>de.editingQuestion.options[s]=e,class:"option-field"},null,8,ne),[[l.Jo,de.editingQuestion.options[s]]]),(0,i.Lk)("button",{onClick:e=>ce.removeOption(s),class:"remove-option-btn"},"✕",8,le)])))),128)),(0,i.Lk)("button",{onClick:s[14]||(s[14]=(...e)=>ce.addOption&&ce.addOption(...e)),class:"add-option-btn"},(0,n.v_)(e.$t("surveys.addOption")),1)])):(0,i.Q3)("",!0),"scale"===de.editingQuestion.type?((0,i.uX)(),(0,i.CE)("div",ae,[(0,i.Lk)("label",null,(0,n.v_)(e.$t("surveys.scaleRange")),1),(0,i.Lk)("div",oe,[(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":s[15]||(s[15]=e=>de.scaleMin=e),type:"number",min:"1",max:"10"},null,512),[[l.Jo,de.scaleMin,void 0,{number:!0}]]),s[22]||(s[22]=(0,i.Lk)("span",null,"-",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":s[16]||(s[16]=e=>de.scaleMax=e),type:"number",min:"1",max:"10"},null,512),[[l.Jo,de.scaleMax,void 0,{number:!0}]])])])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",re,[(0,i.Lk)("button",{onClick:s[17]||(s[17]=(...e)=>ce.saveQuestion&&ce.saveQuestion(...e)),class:"save-btn"},(0,n.v_)(e.$t("surveys.saveQuestion")),1),(0,i.Lk)("button",{onClick:s[18]||(s[18]=(...e)=>ce.closeQuestionEdit&&ce.closeQuestionEdit(...e)),class:"cancel-btn"},(0,n.v_)(e.$t("surveys.cancel")),1)])])])):(0,i.Q3)("",!0)])}t(4114),t(8111),t(2489),t(116),t(1701);var de=t(4373),ce={name:"SurveyList",data(){return{selectedType:"",surveyTitle:"",selectedTeamId:"",selectedEmployeeId:"",deadline:"",emailList:"",teams:[],employees:[],surveys:[],loading:!1,showPreview:!1,showQuestionEdit:!1,currentQuestions:[],editingQuestion:null,editingQuestionIndex:-1,scaleMin:1,scaleMax:5}},computed:{canPreviewSurvey(){return this.surveyTitle&&("enps"===this.selectedType&&this.selectedTeamId||"360"===this.selectedType&&this.selectedEmployeeId)&&this.emailList},emailArray(){return this.emailList.split(",").map((e=>e.trim())).filter((e=>e))}},async mounted(){await this.fetchTeams(),await this.fetchEmployees(),await this.fetchSurveys()},methods:{async fetchTeams(){try{const e=localStorage.getItem("token"),s=await de.A.get("/user_teams",{headers:{Authorization:`Bearer ${e}`}});this.teams=s.data}catch(e){console.error("Error fetching teams:",e)}},async fetchEmployees(){try{const e=localStorage.getItem("token"),s=await de.A.get("/api/employees",{headers:{Authorization:`Bearer ${e}`}});this.employees=s.data}catch(e){console.error("Error fetching employees:",e)}},async fetchSurveys(){try{this.loading=!0;const e=localStorage.getItem("token"),s=await de.A.get("/api/surveys",{headers:{Authorization:`Bearer ${e}`}});this.surveys=s.data}catch(e){console.error("Error fetching surveys:",e)}finally{this.loading=!1}},previewSurvey(){"enps"===this.selectedType?this.currentQuestions=this.getEnpsTemplate():"360"===this.selectedType&&(this.currentQuestions=this.get360Template()),this.showPreview=!0},closePreview(){this.showPreview=!1},editSurvey(){this.showPreview=!1},async createAndSendSurvey(){try{const e=localStorage.getItem("token"),s=this.emailArray,t={survey_type:this.selectedType,title:this.surveyTitle,team_id:this.selectedTeamId||null,target_employee_id:this.selectedEmployeeId||null,deadline:null,questions:this.currentQuestions},i=await de.A.post("/api/surveys",t,{headers:{Authorization:`Bearer ${e}`}}),n=i.data.id;await de.A.post(`/api/surveys/${n}/send`,{emails:s},{headers:{Authorization:`Bearer ${e}`}}),alert(this.$t("surveys.surveyCreated")),this.resetForm(),this.showPreview=!1,await this.fetchSurveys()}catch(e){console.error("Error creating survey:",e),alert("Ошибка создания опросника")}},resetForm(){this.selectedType="",this.surveyTitle="",this.selectedTeamId="",this.selectedEmployeeId="",this.deadline="",this.emailList="",this.currentQuestions=[]},editQuestion(e){this.editingQuestionIndex=e,this.editingQuestion=JSON.parse(JSON.stringify(this.currentQuestions[e])),"scale"===this.editingQuestion.type&&this.editingQuestion.scale&&(this.scaleMin=this.editingQuestion.scale[0],this.scaleMax=this.editingQuestion.scale[this.editingQuestion.scale.length-1]),this.showQuestionEdit=!0},closeQuestionEdit(){this.showQuestionEdit=!1,this.editingQuestion=null,this.editingQuestionIndex=-1},saveQuestion(){if("scale"===this.editingQuestion.type){this.editingQuestion.scale=[];for(let e=this.scaleMin;e<=this.scaleMax;e++)this.editingQuestion.scale.push(e)}this.currentQuestions[this.editingQuestionIndex]=this.editingQuestion,this.closeQuestionEdit()},addOption(){this.editingQuestion.options||(this.editingQuestion.options=[]),this.editingQuestion.options.push("")},removeOption(e){this.editingQuestion.options.splice(e,1)},getTeamName(e){const s=this.teams.find((s=>s.id==e));return s?s.name:""},getEmployeeName(e){const s=this.employees.find((s=>s.id==e));return s?s.name:""},formatDeadline(e){return new Date(e).toLocaleString("ru-RU")},getEnpsTemplate(){return[{id:1,type:"radio",question:"Укажите ваш формат работы:",options:["Офисный","Удаленный","Гибридный"],required:!0},{id:2,type:"textarea",question:"Какие шаги, по вашему мнению, компания могла бы предпринять для улучшения вашего опыта работы?",required:!1},{id:3,type:"scale",question:"Насколько вы удовлетворены своим опытом работы в компании?",scale:[1,2,3,4,5],required:!0},{id:4,type:"textarea",question:"Какие меры, на ваш взгляд, компания могла бы принять, чтобы вы охотнее рекомендовали ее своим друзьям как место для работы?",required:!1},{id:5,type:"scale",question:"Порекомендовали бы вы работать здесь своим друзьям?",scale:[1,2,3,4,5],required:!0},{id:6,type:"scale",question:"Чувствуете ли вы, что у вас есть возможность расти в этой компании?",scale:[1,2,3,4,5],required:!0},{id:7,type:"textarea",question:"Какие изменения, по вашему мнению, руководство могло бы внести для улучшения качества рабочих условий сотрудников?",required:!0},{id:8,type:"scale",question:"Считаете ли вы, что у вас есть все ресурсы и инструменты, необходимые для выполнения вашей работы эффективно?",scale:[1,2,3,4,5],required:!0},{id:9,type:"scale",question:"В какой степени вы чувствуете, что растете внутри компании как эксперт в своей области?",scale:[1,2,3,4,5],required:!0}]},get360Template(){return[{id:1,type:"text",question:"Имя",required:!0},{id:2,type:"textarea",question:"В чем заключаются ключевые личные, профессиональные и лидерские (если применимо) таланты сотрудника?",required:!1},{id:3,type:"textarea",question:"Каковы области личного, профессионального и лидерского (если применимо) совершенствования и развития сотрудника?",required:!1},{id:4,type:"textarea",question:"На основе ваших наблюдений приведите примеры того, как сотрудник развивается личностно, профессионально и как лидер (если применимо).",required:!1},{id:5,type:"textarea",question:"Другие комментарии",required:!1},{id:6,type:"matrix",question:"Оцените",required:!0,rows:["Межличностные: Предоставление обратной связи","Межличностные: Лидерство (если применимо)","Социальное: Эффективное общение","Решение проблем: Достижение результатов","Решение проблем: Движущая сила инноваций","Социальное: Сотрудничество (отношение к командной работе)","Профессионал: Ответственность и подотчетность","Профессионал: Профессиональная компетентность","Профессионал: Продуктивность и организация труда","Межличностные: Взаимное уважение"],scale:["Требует срочной корректировки","Требует улучшения","Соответствует занимаемой должности","Превосходит ожидания","Выдающийся результат"]}]},viewResults(e){this.$router.push(`/survey/${e}/results`)},async copySurveyLink(e){try{const s=`${window.location.origin}/survey/${e.access_token}`;await navigator.clipboard.writeText(s),alert("Ссылка скопирована в буфер обмена!")}catch(s){console.error("Error copying link:",s)}}}},ve=t(1241);const ye=(0,ve.A)(ce,[["render",ue],["__scopeId","data-v-42a628a8"]]);var pe=ye}}]);
//# sourceMappingURL=564.127e63a9.js.map