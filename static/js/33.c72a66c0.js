"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[33],{6033:function(a,e,t){t.r(e),t.d(e,{default:function(){return G}});var l=t(6768),s=t(4232),o=t(5130);const r={class:"motivation-container"},i={class:"employee-list"},n=["onClick"],c=["src","onClick"],m={class:"card-header"},d={class:"employee-name"},u=["onClick"],p={class:"team-name"},v={class:"disc-type-full"},k={class:"employee-card-footer"},h=["onClick"],f={key:0,class:"factors"},y={class:"column"},L={class:"column"},g=["innerHTML"],C={key:0,class:"modal-overlay"},b={class:"modal-content"},E={class:"input-wrapper"},_={class:"floating-label"},w={class:"input-wrapper"},A={class:"floating-label"},x={class:"input-wrapper"},M=["value"],I={class:"floating-label"},T={class:"input-wrapper textarea-wrapper"},$={class:"input-wrapper textarea-wrapper"},S={class:"input-wrapper textarea-wrapper"},X={class:"input-wrapper textarea-wrapper"},F={class:"modal-actions"},D=["disabled"],U=["disabled"],q={key:0},J={key:1},K={key:1,class:"modal-overlay"},V={class:"modal-content avatar-modal"},z={class:"avatar-section"},N={class:"avatar-grid"},j=["src","onClick"],B={class:"avatar-section"},Z={class:"avatar-grid"},O=["src","onClick"];function Q(a,e,t,Q,H,P){return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("div",r,[(0,l.Lk)("h1",null,(0,s.v_)(a.$t("motivation.title")),1),(0,l.Lk)("div",i,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(H.employees,(a=>((0,l.uX)(),(0,l.CE)("div",{key:a.id,class:"employee-card",onClick:e=>P.selectEmployee(a)},[(0,l.Lk)("img",{class:"avatar",src:P.getAvatarUrl(a),alt:"avatar",onClick:e=>P.openAvatarModal(a),onError:e[0]||(e[0]=(...a)=>P.setDefaultAvatar&&P.setDefaultAvatar(...a))},null,40,c),(0,l.Lk)("div",m,[(0,l.Lk)("h4",d,(0,s.v_)(a.name),1),(0,l.Lk)("button",{class:"delete-btn",onClick:(0,o.D$)((e=>P.deleteEmployee(a.id)),["stop"])},"üóë",8,u)]),(0,l.Lk)("p",p,[e[14]||(e[14]=(0,l.eW)("üè¢ –ö–æ–º–∞–Ω–¥–∞: ")),(0,l.Lk)("strong",null,(0,s.v_)(P.getTeamName(a.team_id)||"‚Äî"),1)]),(0,l.Lk)("p",v,[e[15]||(e[15]=(0,l.eW)("üß† –¢–∏–ø DISC: ")),(0,l.Lk)("strong",null,(0,s.v_)(P.extractDISCFullType(a.ai_analysis)),1)]),(0,l.Lk)("div",k,[(0,l.Lk)("button",{class:"update-btn",onClick:e=>P.handleEmployeeClick(a)}," üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ ",8,h)]),a.ai_analysis?((0,l.uX)(),(0,l.CE)("div",f,[(0,l.Lk)("div",y,[e[16]||(e[16]=(0,l.Lk)("h5",null,"‚¨ÜÔ∏è –ú–æ—Ç–∏–≤–∞—Ç–æ—Ä—ã",-1)),(0,l.Lk)("ul",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.motivators,(a=>((0,l.uX)(),(0,l.CE)("li",{key:a},(0,s.v_)(a),1)))),128))])]),(0,l.Lk)("div",L,[e[17]||(e[17]=(0,l.Lk)("h5",null,"‚¨áÔ∏è –î–µ–º–æ—Ç–∏–≤–∞—Ç–æ—Ä—ã",-1)),(0,l.Lk)("ul",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.demotivators,(a=>((0,l.uX)(),(0,l.CE)("li",{key:a},(0,s.v_)(a),1)))),128))])])])):(0,l.Q3)("",!0),a.ai_analysis?((0,l.uX)(),(0,l.CE)("div",{key:1,class:"manager-tips-block",innerHTML:P.extractManagerTips(a.ai_analysis)},null,8,g)):(0,l.Q3)("",!0),e[18]||(e[18]=(0,l.Lk)("div",{class:"form-footer"},null,-1))],8,n)))),128)),(0,l.Lk)("div",{class:"employee-card add-card",onClick:e[1]||(e[1]=(...a)=>P.resetForm&&P.resetForm(...a))},[e[19]||(e[19]=(0,l.Lk)("span",null,"‚ûï",-1)),(0,l.Lk)("p",null,(0,s.v_)(a.$t("motivation.addEmployee")),1)])])]),H.showModal?((0,l.uX)(),(0,l.CE)("div",C,[(0,l.Lk)("div",b,[(0,l.Lk)("form",{onSubmit:e[12]||(e[12]=(0,o.D$)(((...a)=>P.submitMotivation&&P.submitMotivation(...a)),["prevent"])),class:"form-group modern-form"},[(0,l.Lk)("div",E,[e[20]||(e[20]=(0,l.Lk)("span",{class:"input-icon"},"üë§",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>H.form.name=a),required:"",class:(0,s.C4)(["modern-input",{"has-value":H.form.name}])},null,2),[[o.Jo,H.form.name]]),(0,l.Lk)("label",_,(0,s.v_)(a.$t("motivation.employeeName")),1)]),(0,l.Lk)("div",w,[e[21]||(e[21]=(0,l.Lk)("span",{class:"input-icon"},"üíº",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>H.form.role=a),required:"",class:(0,s.C4)(["modern-input",{"has-value":H.form.role}])},null,2),[[o.Jo,H.form.role]]),(0,l.Lk)("label",A,(0,s.v_)(a.$t("motivation.role")),1)]),(0,l.Lk)("div",x,[e[23]||(e[23]=(0,l.Lk)("span",{class:"input-icon"},"üè¢",-1)),(0,l.bo)((0,l.Lk)("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>H.form.team_id=a),class:(0,s.C4)(["modern-input modern-select",{"has-value":H.form.team_id}])},[e[22]||(e[22]=(0,l.Lk)("option",{value:""},null,-1)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(H.teams,(a=>((0,l.uX)(),(0,l.CE)("option",{key:a.id,value:a.id},(0,s.v_)(a.name),9,M)))),128))],2),[[o.u1,H.form.team_id]]),(0,l.Lk)("label",I,(0,s.v_)(a.$t("motivation.team"))+" ("+(0,s.v_)(a.$t("common.select"))+")",1)]),(0,l.Lk)("div",T,[e[24]||(e[24]=(0,l.Lk)("span",{class:"input-icon"},"üò∞",-1)),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":e[5]||(e[5]=a=>H.form.stress=a),required:"",class:(0,s.C4)(["modern-input modern-textarea",{"has-value":H.form.stress}])},null,2),[[o.Jo,H.form.stress]]),e[25]||(e[25]=(0,l.Lk)("label",{class:"floating-label"},"1. –ü–æ–≤–µ–¥–µ–Ω–∏–µ –≤ —Å—Ç—Ä–µ—Å—Å–æ–≤–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏",-1))]),(0,l.Lk)("div",$,[e[26]||(e[26]=(0,l.Lk)("span",{class:"input-icon"},"ü§ù",-1)),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":e[6]||(e[6]=a=>H.form.communication=a),required:"",class:(0,s.C4)(["modern-input modern-textarea",{"has-value":H.form.communication}])},null,2),[[o.Jo,H.form.communication]]),e[27]||(e[27]=(0,l.Lk)("label",{class:"floating-label"},"2. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –¥—Ä—É–≥–∏–º–∏",-1))]),(0,l.Lk)("div",S,[e[28]||(e[28]=(0,l.Lk)("span",{class:"input-icon"},"‚ö°",-1)),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":e[7]||(e[7]=a=>H.form.behavior=a),required:"",class:(0,s.C4)(["modern-input modern-textarea",{"has-value":H.form.behavior}])},null,2),[[o.Jo,H.form.behavior]]),e[29]||(e[29]=(0,l.Lk)("label",{class:"floating-label"},"3. –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤ —Ä–∞–±–æ—Ç–µ",-1))]),(0,l.Lk)("div",X,[e[30]||(e[30]=(0,l.Lk)("span",{class:"input-icon"},"üí¨",-1)),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":e[8]||(e[8]=a=>H.form.feedback=a),required:"",class:(0,s.C4)(["modern-input modern-textarea",{"has-value":H.form.feedback}])},null,2),[[o.Jo,H.form.feedback]]),e[31]||(e[31]=(0,l.Lk)("label",{class:"floating-label"},"4. –†–µ–∞–∫—Ü–∏–∏ –Ω–∞ –∫—Ä–∏—Ç–∏–∫—É –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è",-1))]),(0,l.Lk)("div",F,[(0,l.Lk)("button",{onClick:e[9]||(e[9]=a=>P.submitMotivation(!1)),disabled:H.loading}," üíæ "+(0,s.v_)(a.$t("common.save")),9,D),(0,l.Lk)("button",{onClick:e[10]||(e[10]=a=>P.submitMotivation(!0)),disabled:H.loading},[H.loading?((0,l.uX)(),(0,l.CE)("span",q,"‚è≥ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è...")):((0,l.uX)(),(0,l.CE)("span",J,"üí¨ "+(0,s.v_)(a.$t("motivation.analyze")),1))],8,U),(0,l.Lk)("button",{class:"modal-close",onClick:e[11]||(e[11]=a=>H.showModal=!1)},"‚úñ")])],32)])])):(0,l.Q3)("",!0),H.showAvatarModal?((0,l.uX)(),(0,l.CE)("div",K,[(0,l.Lk)("div",V,[e[34]||(e[34]=(0,l.Lk)("h2",null,"üé≠ –í—ã–±–æ—Ä –∞–≤–∞—Ç–∞—Ä–∞",-1)),(0,l.Lk)("div",z,[e[32]||(e[32]=(0,l.Lk)("h3",null,"üë® –ú—É–∂—Å–∫–∏–µ",-1)),(0,l.Lk)("div",N,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(H.avatars.male,(a=>((0,l.uX)(),(0,l.CE)("img",{key:a,src:`/avatars/${a}`,class:"avatar-option",onClick:e=>P.selectAvatar(a)},null,8,j)))),128))])]),(0,l.Lk)("div",B,[e[33]||(e[33]=(0,l.Lk)("h3",null,"üë© –ñ–µ–Ω—Å–∫–∏–µ",-1)),(0,l.Lk)("div",Z,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(H.avatars.female,(a=>((0,l.uX)(),(0,l.CE)("img",{key:a,src:`/avatars/${a}`,class:"avatar-option",onClick:e=>P.selectAvatar(a)},null,8,O)))),128))])]),(0,l.Lk)("button",{class:"modal-close",onClick:e[13]||(e[13]=a=>H.showAvatarModal=!1)},"‚úñ")])])):(0,l.Q3)("",!0)],64)}t(4114),t(8111),t(2489),t(116),t(1701);var H={data(){return{form:{id:null,name:"",role:"",team_id:"",stress:"",communication:"",behavior:"",feedback:""},teams:[],employees:[],result:"",loading:!1,showModal:!1,showAvatarModal:!1,selectedEmployee:null,avatars:{male:["male1.png","male2.png","male3.png","male4.png","male5.png","male6.png"],female:["female1.png","female2.png","female3.png","female4.png","female5.png","female6.png"]},avatar:"default.png"}},async mounted(){const a=localStorage.getItem("token");try{const e=await fetch("/user_teams",{headers:{Authorization:`Bearer ${a}`}});this.teams=await e.json();const t=await fetch("/employees",{headers:{Authorization:`Bearer ${a}`}}),l=await t.json();if(!Array.isArray(l))return void console.error("–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –Ω–µ –ø–æ–ª—É—á–µ–Ω—ã:",l);this.employees=l.map((a=>({...a,motivators:this.extractFactors(a.ai_analysis,"–ú–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–µ"),demotivators:this.extractFactors(a.ai_analysis,"–î–µ–º–æ—Ç–∏–≤–∞—Ç–æ—Ä—ã"),managerTips:this.extractManagerTips(a.ai_analysis)})))}catch(e){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ:",e)}},methods:{async submitMotivation(a=!1){this.loading=!0;const e=localStorage.getItem("token"),t=a?"/motivation":"/employees",l="POST";try{const a=await fetch(t,{method:l,headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({...this.form,id:this.form.id,team_id:this.form.team_id||null})}),s=await a.json();if(a.ok){this.result=s.analysis||s.message,this.form.id=s.employee_id||s.id;const a={...this.form,id:this.form.id,ai_analysis:s.analysis||"",motivators:this.extractFactors(s.analysis,"–ú–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–µ"),demotivators:this.extractFactors(s.analysis,"–î–µ–º–æ—Ç–∏–≤–∞—Ç–æ—Ä—ã"),managerTips:this.extractManagerTips(s.analysis)},e=this.employees.findIndex((a=>a.id===this.form.id));-1!==e?this.employees.splice(e,1,a):this.employees.push(a),this.showModal=!1,setTimeout((()=>{location.reload()}),300)}else alert(s.error||"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è")}catch(s){console.error(s),alert("–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è")}finally{this.loading=!1}},resetForm(){this.form={id:null,name:"",role:"",team_id:"",stress:"",communication:"",behavior:"",feedback:""},this.result="",this.showModal=!0},async deleteEmployee(a){const e=localStorage.getItem("token");if(confirm(this.$t("motivation.confirmDelete")))try{await fetch(`/employee/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${e}`}}),this.employees=this.employees.filter((e=>e.id!==a))}catch(t){console.error("–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è",t)}},handleEmployeeClick(a){this.selectEmployee(a),this.showModal=!0},selectEmployee(a){this.form={...a},this.result=a.ai_analysis},extractDISCFullType(a){if(!a)return"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ";const e=a.match(/–¢–∏–ø DISC[:-]?\s*<\/?strong>?[\s"]*([A-Z–ê-–Ø]\s*\([^)]+?\))/i)||a.match(/–¢–∏–ø DISC[:-]?\s*([A-Z–ê-–Ø]\s*\([^)]+?\))/i);return e?e[1].trim():"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"},extractFactors(a,e){if(!a)return[];const t=document.createElement("div");t.innerHTML=a;const l=Array.from(t.querySelectorAll("h3, h4, strong")),s=l.find((a=>a.textContent.toLowerCase().includes(e.toLowerCase())));if(!s)return[];const o=s.nextElementSibling;return o&&"UL"===o.tagName?Array.from(o.querySelectorAll("li")).map((a=>a.textContent.trim())):[]},extractDISCType(a){if(!a)return"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ";const e=a.match(/–¢–∏–ø DISC[:-]?\s*<\/?strong>?[\s"]*([A-Z–ê-–Ø][^)<\n:]*\([A-Z–ê-–Ø]\))/i)||a.match(/—Ç–∏–ø\s+[A-Z–ê-–Ø]\s*\([^)]+\)/i)||a.match(/—Ç–∏–ø\s+["¬´]?(.)["¬ª]?/i);return e?e[1].trim():"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"},extractManagerTips(a){if(!a)return"";const e=a.match(/<h3>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è:.*?<\/ul>/is);return e?e[0]:""},getTeamName(a){const e=this.teams.find((e=>e.id===a));return e?e.name:"‚Äî"},getAvatarUrl(a){return`/avatars/${a.avatar||"default.png"}`},openAvatarModal(a){this.selectedEmployee=a,this.showAvatarModal=!0},async selectAvatar(a){if(!this.selectedEmployee)return;const e=localStorage.getItem("token");try{const t=await fetch("/employees",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({...this.selectedEmployee,avatar:a})});if(t.ok){const e=this.employees.findIndex((a=>a.id===this.selectedEmployee.id));-1!==e&&(this.employees[e].avatar=a),this.showAvatarModal=!1}}catch(t){console.error("Error updating avatar:",t)}},setDefaultAvatar(a){a.target.src="/avatars/default.png"}}},P=t(1241);const W=(0,P.A)(H,[["render",Q],["__scopeId","data-v-742f13aa"]]);var G=W}}]);
//# sourceMappingURL=33.c72a66c0.js.map