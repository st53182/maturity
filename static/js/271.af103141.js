"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[271],{3271:function(e,s,t){t.r(s),t.d(s,{default:function(){return me}});var i=t(6768),n=t(4232),l=t(5130);const a={class:"surveys-container"},o={class:"create-survey-section"},u={class:"survey-type-selection"},r={key:0,class:"survey-form"},d=["placeholder"],c={value:""},v=["value"],y={value:""},p=["value"],h={class:"deadline-field"},k={for:"deadline",class:"deadline-label"},m={class:"deadline-help"},L=["placeholder"],g=["disabled"],Q=["disabled"],_={class:"existing-surveys"},w={key:0,class:"loading"},b={key:1,class:"no-surveys"},E={key:2,class:"surveys-grid"},C={class:"survey-header"},q={class:"survey-type"},$={class:"survey-stats"},T={class:"survey-actions"},f=["onClick"],S=["onClick"],X={key:0,class:"preview-modal"},x={class:"preview-content"},I={class:"preview-header"},A={class:"preview-body"},P={class:"survey-info"},U={key:0},V={key:1},M={key:2},J={class:"questions-preview"},F={class:"question-header"},O={class:"question-number"},K={class:"question-text"},N={key:0,class:"required-mark"},z=["onClick"],B={class:"question-type-info"},R={class:"question-type"},W={key:0,class:"options-count"},D={key:1,class:"scale-info"},H={key:2,class:"matrix-info"},j={class:"email-preview"},G={class:"email-list"},Y={class:"recipient-count"},Z={class:"preview-actions"},ee={key:1,class:"question-edit-modal"},se={class:"question-edit-content"},te={class:"edit-header"},ie={class:"edit-body"},ne={class:"form-group"},le={class:"form-group"},ae={key:0,class:"form-group"},oe=["onUpdate:modelValue"],ue=["onClick"],re={key:1,class:"form-group"},de={class:"scale-inputs"},ce={class:"edit-actions"};function ve(e,s,t,ve,ye,pe){return(0,i.uX)(),(0,i.CE)("div",a,[(0,i.Lk)("h1",null,"📋 "+(0,n.v_)(e.$t("surveys.title")),1),(0,i.Lk)("div",o,[(0,i.Lk)("h2",null,(0,n.v_)(e.$t("surveys.createSurvey")),1),(0,i.Lk)("div",u,[(0,i.Lk)("div",{class:(0,n.C4)(["survey-type-card",{active:"enps"===ye.selectedType}]),onClick:s[0]||(s[0]=e=>ye.selectedType="enps")},[(0,i.Lk)("h3",null,"📊 "+(0,n.v_)(e.$t("surveys.enpsTitle")),1),s[20]||(s[20]=(0,i.Lk)("p",null,"Собрать обратную связь от сотрудников о текущем состоянии в команде",-1))],2),(0,i.Lk)("div",{class:(0,n.C4)(["survey-type-card",{active:"360"===ye.selectedType}]),onClick:s[1]||(s[1]=e=>ye.selectedType="360")},[(0,i.Lk)("h3",null,"🔄 "+(0,n.v_)(e.$t("surveys.feedback360Title")),1),s[21]||(s[21]=(0,i.Lk)("p",null,"Собрать анонимную обратную связь о конкретном сотруднике от коллег",-1))],2)]),ye.selectedType?((0,i.uX)(),(0,i.CE)("div",r,[(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>ye.surveyTitle=e),placeholder:e.$t("surveys.surveyTitle"),class:"survey-input"},null,8,d),[[l.Jo,ye.surveyTitle]]),"enps"===ye.selectedType?(0,i.bo)(((0,i.uX)(),(0,i.CE)("select",{key:0,"onUpdate:modelValue":s[3]||(s[3]=e=>ye.selectedTeamId=e),class:"survey-select"},[(0,i.Lk)("option",c,(0,n.v_)(e.$t("surveys.selectTeam")),1),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(ye.teams,(e=>((0,i.uX)(),(0,i.CE)("option",{key:e.id,value:e.id},(0,n.v_)(e.name),9,v)))),128))],512)),[[l.u1,ye.selectedTeamId]]):(0,i.Q3)("",!0),"360"===ye.selectedType?(0,i.bo)(((0,i.uX)(),(0,i.CE)("select",{key:1,"onUpdate:modelValue":s[4]||(s[4]=e=>ye.selectedEmployeeId=e),class:"survey-select"},[(0,i.Lk)("option",y,(0,n.v_)(e.$t("surveys.selectEmployee")),1),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(ye.employees,(e=>((0,i.uX)(),(0,i.CE)("option",{key:e.id,value:e.id},(0,n.v_)(e.name),9,p)))),128))],512)),[[l.u1,ye.selectedEmployeeId]]):(0,i.Q3)("",!0),(0,i.Lk)("div",h,[(0,i.Lk)("label",k,(0,n.v_)(e.$t("surveys.deadlineLabel")),1),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":s[5]||(s[5]=e=>ye.deadline=e),id:"deadline",type:"datetime-local",class:"survey-input"},null,512),[[l.Jo,ye.deadline]]),(0,i.Lk)("small",m,(0,n.v_)(e.$t("surveys.deadlineHelp")),1)]),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":s[6]||(s[6]=e=>ye.emailList=e),placeholder:e.$t("surveys.emailPlaceholder"),class:"survey-textarea",rows:"3"},null,8,L),[[l.Jo,ye.emailList]]),(0,i.Lk)("button",{onClick:s[7]||(s[7]=(...e)=>pe.previewSurvey&&pe.previewSurvey(...e)),disabled:!pe.canPreviewSurvey,class:"preview-survey-btn"},(0,n.v_)(e.$t("surveys.previewSurvey")),9,g),(0,i.Lk)("button",{onClick:s[8]||(s[8]=(...e)=>pe.createAndSendSurvey&&pe.createAndSendSurvey(...e)),disabled:!pe.canPreviewSurvey,class:"create-survey-btn"},(0,n.v_)(e.$t("surveys.createAndSend")),9,Q)])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",_,[s[22]||(s[22]=(0,i.Lk)("h2",null,"Мои опросники",-1)),ye.loading?((0,i.uX)(),(0,i.CE)("div",w,"⏳ Загрузка...")):0===ye.surveys.length?((0,i.uX)(),(0,i.CE)("div",b," Нет созданных опросников ")):((0,i.uX)(),(0,i.CE)("div",E,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(ye.surveys,(s=>((0,i.uX)(),(0,i.CE)("div",{key:s.id,class:"survey-card"},[(0,i.Lk)("div",C,[(0,i.Lk)("h3",null,(0,n.v_)(s.title),1),(0,i.Lk)("span",q,(0,n.v_)(s.survey_type.toUpperCase()),1)]),(0,i.Lk)("div",$,[(0,i.Lk)("span",null,(0,n.v_)(e.$t("surveys.responses"))+": "+(0,n.v_)(s.response_count),1),(0,i.Lk)("span",{class:(0,n.C4)(["survey-status",s.status])},(0,n.v_)(e.$t(`surveys.surveyStatus.${s.status}`)),3)]),(0,i.Lk)("div",T,[(0,i.Lk)("button",{onClick:e=>pe.viewResults(s.id),class:"view-results-btn"}," 📊 "+(0,n.v_)(e.$t("surveys.analytics")),9,f),(0,i.Lk)("button",{onClick:e=>pe.copySurveyLink(s),class:"copy-link-btn"}," 🔗 "+(0,n.v_)(e.$t("surveys.copyLink")),9,S)])])))),128))]))]),ye.showPreview?((0,i.uX)(),(0,i.CE)("div",X,[(0,i.Lk)("div",x,[(0,i.Lk)("div",I,[(0,i.Lk)("h2",null,(0,n.v_)(e.$t("surveys.previewTitle"))+": "+(0,n.v_)(ye.surveyTitle),1),(0,i.Lk)("button",{onClick:s[9]||(s[9]=(...e)=>pe.closePreview&&pe.closePreview(...e)),class:"close-btn"},"✕")]),(0,i.Lk)("div",A,[(0,i.Lk)("div",P,[(0,i.Lk)("p",null,[(0,i.Lk)("strong",null,(0,n.v_)(e.$t("surveys.surveyType"))+":",1),(0,i.eW)(" "+(0,n.v_)(ye.selectedType.toUpperCase()),1)]),"enps"===ye.selectedType?((0,i.uX)(),(0,i.CE)("p",U,[(0,i.Lk)("strong",null,(0,n.v_)(e.$t("surveys.team"))+":",1),(0,i.eW)(" "+(0,n.v_)(pe.getTeamName(ye.selectedTeamId)),1)])):(0,i.Q3)("",!0),"360"===ye.selectedType?((0,i.uX)(),(0,i.CE)("p",V,[(0,i.Lk)("strong",null,(0,n.v_)(e.$t("surveys.employee"))+":",1),(0,i.eW)(" "+(0,n.v_)(pe.getEmployeeName(ye.selectedEmployeeId)),1)])):(0,i.Q3)("",!0),ye.deadline?((0,i.uX)(),(0,i.CE)("p",M,[(0,i.Lk)("strong",null,(0,n.v_)(e.$t("surveys.deadlineLabel"))+":",1),(0,i.eW)(" "+(0,n.v_)(pe.formatDeadline(ye.deadline)),1)])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",J,[(0,i.Lk)("h3",null,(0,n.v_)(e.$t("surveys.questionsPreview")),1),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(ye.currentQuestions,((s,t)=>((0,i.uX)(),(0,i.CE)("div",{key:s.id,class:"question-preview"},[(0,i.Lk)("div",F,[(0,i.Lk)("span",O,(0,n.v_)(t+1)+".",1),(0,i.Lk)("span",K,(0,n.v_)(s.question),1),s.required?((0,i.uX)(),(0,i.CE)("span",N,"*")):(0,i.Q3)("",!0),(0,i.Lk)("button",{onClick:e=>pe.editQuestion(t),class:"edit-question-btn"},"✏️",8,z)]),(0,i.Lk)("div",B,[(0,i.Lk)("span",R,(0,n.v_)(e.$t(`surveys.questionTypes.${s.type}`)),1),s.options?((0,i.uX)(),(0,i.CE)("span",W," ("+(0,n.v_)(s.options.length)+" "+(0,n.v_)(e.$t("surveys.options"))+") ",1)):(0,i.Q3)("",!0),s.scale?((0,i.uX)(),(0,i.CE)("span",D," ("+(0,n.v_)(e.$t("surveys.scale"))+": "+(0,n.v_)(s.scale[0])+"-"+(0,n.v_)(s.scale[s.scale.length-1])+") ",1)):(0,i.Q3)("",!0),s.rows?((0,i.uX)(),(0,i.CE)("span",H," ("+(0,n.v_)(s.rows.length)+" "+(0,n.v_)(e.$t("surveys.competencies"))+") ",1)):(0,i.Q3)("",!0)])])))),128))]),(0,i.Lk)("div",j,[(0,i.Lk)("h3",null,(0,n.v_)(e.$t("surveys.recipientsPreview")),1),(0,i.Lk)("div",G,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(pe.emailArray,(e=>((0,i.uX)(),(0,i.CE)("span",{key:e,class:"email-tag"},(0,n.v_)(e),1)))),128))]),(0,i.Lk)("p",Y,(0,n.v_)(e.$t("surveys.totalRecipients"))+": "+(0,n.v_)(pe.emailArray.length),1)])]),(0,i.Lk)("div",Z,[(0,i.Lk)("button",{onClick:s[10]||(s[10]=(...e)=>pe.editSurvey&&pe.editSurvey(...e)),class:"edit-btn"},(0,n.v_)(e.$t("surveys.editSurvey")),1),(0,i.Lk)("button",{onClick:s[11]||(s[11]=(...e)=>pe.createAndSendSurvey&&pe.createAndSendSurvey(...e)),class:"send-btn"},(0,n.v_)(e.$t("surveys.createAndSend")),1)])])])):(0,i.Q3)("",!0),ye.showQuestionEdit?((0,i.uX)(),(0,i.CE)("div",ee,[(0,i.Lk)("div",se,[(0,i.Lk)("div",te,[(0,i.Lk)("h3",null,(0,n.v_)(e.$t("surveys.editQuestion")),1),(0,i.Lk)("button",{onClick:s[12]||(s[12]=(...e)=>pe.closeQuestionEdit&&pe.closeQuestionEdit(...e)),class:"close-btn"},"✕")]),(0,i.Lk)("div",ie,[(0,i.Lk)("div",ne,[(0,i.Lk)("label",null,(0,n.v_)(e.$t("surveys.questionText")),1),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":s[13]||(s[13]=e=>ye.editingQuestion.question=e),class:"question-input",rows:"3"},null,512),[[l.Jo,ye.editingQuestion.question]])]),(0,i.Lk)("div",le,[(0,i.Lk)("label",null,[(0,i.bo)((0,i.Lk)("input",{type:"checkbox","onUpdate:modelValue":s[14]||(s[14]=e=>ye.editingQuestion.required=e)},null,512),[[l.lH,ye.editingQuestion.required]]),(0,i.eW)(" "+(0,n.v_)(e.$t("surveys.requiredQuestion")),1)])]),"radio"===ye.editingQuestion.type?((0,i.uX)(),(0,i.CE)("div",ae,[(0,i.Lk)("label",null,(0,n.v_)(e.$t("surveys.options")),1),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(ye.editingQuestion.options,((e,s)=>((0,i.uX)(),(0,i.CE)("div",{key:s,class:"option-input"},[(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":e=>ye.editingQuestion.options[s]=e,class:"option-field"},null,8,oe),[[l.Jo,ye.editingQuestion.options[s]]]),(0,i.Lk)("button",{onClick:e=>pe.removeOption(s),class:"remove-option-btn"},"✕",8,ue)])))),128)),(0,i.Lk)("button",{onClick:s[15]||(s[15]=(...e)=>pe.addOption&&pe.addOption(...e)),class:"add-option-btn"},(0,n.v_)(e.$t("surveys.addOption")),1)])):(0,i.Q3)("",!0),"scale"===ye.editingQuestion.type?((0,i.uX)(),(0,i.CE)("div",re,[(0,i.Lk)("label",null,(0,n.v_)(e.$t("surveys.scaleRange")),1),(0,i.Lk)("div",de,[(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":s[16]||(s[16]=e=>ye.scaleMin=e),type:"number",min:"1",max:"10"},null,512),[[l.Jo,ye.scaleMin,void 0,{number:!0}]]),s[23]||(s[23]=(0,i.Lk)("span",null,"-",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":s[17]||(s[17]=e=>ye.scaleMax=e),type:"number",min:"1",max:"10"},null,512),[[l.Jo,ye.scaleMax,void 0,{number:!0}]])])])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",ce,[(0,i.Lk)("button",{onClick:s[18]||(s[18]=(...e)=>pe.saveQuestion&&pe.saveQuestion(...e)),class:"save-btn"},(0,n.v_)(e.$t("surveys.saveQuestion")),1),(0,i.Lk)("button",{onClick:s[19]||(s[19]=(...e)=>pe.closeQuestionEdit&&pe.closeQuestionEdit(...e)),class:"cancel-btn"},(0,n.v_)(e.$t("surveys.cancel")),1)])])])):(0,i.Q3)("",!0)])}t(4114),t(8111),t(2489),t(116),t(1701);var ye=t(4373),pe={name:"SurveyList",data(){return{selectedType:"",surveyTitle:"",selectedTeamId:"",selectedEmployeeId:"",deadline:"",emailList:"",teams:[],employees:[],surveys:[],loading:!1,showPreview:!1,showQuestionEdit:!1,currentQuestions:[],editingQuestion:null,editingQuestionIndex:-1,scaleMin:1,scaleMax:5}},computed:{canPreviewSurvey(){return this.surveyTitle&&("enps"===this.selectedType&&this.selectedTeamId||"360"===this.selectedType&&this.selectedEmployeeId)&&this.emailList},emailArray(){return this.emailList.split(",").map((e=>e.trim())).filter((e=>e))}},async mounted(){await this.fetchTeams(),await this.fetchEmployees(),await this.fetchSurveys()},methods:{async fetchTeams(){try{const e=localStorage.getItem("token"),s=await ye.A.get("/user_teams",{headers:{Authorization:`Bearer ${e}`}});this.teams=s.data}catch(e){console.error("Error fetching teams:",e)}},async fetchEmployees(){try{const e=localStorage.getItem("token"),s=await ye.A.get("/api/employees",{headers:{Authorization:`Bearer ${e}`}});this.employees=s.data}catch(e){console.error("Error fetching employees:",e)}},async fetchSurveys(){try{this.loading=!0;const e=localStorage.getItem("token"),s=await ye.A.get("/api/surveys",{headers:{Authorization:`Bearer ${e}`}});this.surveys=s.data}catch(e){console.error("Error fetching surveys:",e)}finally{this.loading=!1}},previewSurvey(){"enps"===this.selectedType?this.currentQuestions=this.getEnpsTemplate():"360"===this.selectedType&&(this.currentQuestions=this.get360Template()),this.showPreview=!0},closePreview(){this.showPreview=!1},editSurvey(){this.showPreview=!1},async createAndSendSurvey(){try{const e=localStorage.getItem("token"),s=this.emailArray,t={survey_type:this.selectedType,title:this.surveyTitle,team_id:this.selectedTeamId||null,target_employee_id:this.selectedEmployeeId||null,deadline:this.deadline||null,questions:this.currentQuestions},i=await ye.A.post("/api/surveys",t,{headers:{Authorization:`Bearer ${e}`}}),n=i.data.id;await ye.A.post(`/api/surveys/${n}/send`,{emails:s},{headers:{Authorization:`Bearer ${e}`}}),alert(this.$t("surveys.surveyCreated")),this.resetForm(),this.showPreview=!1,await this.fetchSurveys()}catch(e){console.error("Error creating survey:",e),alert("Ошибка создания опросника")}},resetForm(){this.selectedType="",this.surveyTitle="",this.selectedTeamId="",this.selectedEmployeeId="",this.deadline="",this.emailList="",this.currentQuestions=[]},editQuestion(e){this.editingQuestionIndex=e,this.editingQuestion=JSON.parse(JSON.stringify(this.currentQuestions[e])),"scale"===this.editingQuestion.type&&this.editingQuestion.scale&&(this.scaleMin=this.editingQuestion.scale[0],this.scaleMax=this.editingQuestion.scale[this.editingQuestion.scale.length-1]),this.showQuestionEdit=!0},closeQuestionEdit(){this.showQuestionEdit=!1,this.editingQuestion=null,this.editingQuestionIndex=-1},saveQuestion(){if("scale"===this.editingQuestion.type){this.editingQuestion.scale=[];for(let e=this.scaleMin;e<=this.scaleMax;e++)this.editingQuestion.scale.push(e)}this.currentQuestions[this.editingQuestionIndex]=this.editingQuestion,this.closeQuestionEdit()},addOption(){this.editingQuestion.options||(this.editingQuestion.options=[]),this.editingQuestion.options.push("")},removeOption(e){this.editingQuestion.options.splice(e,1)},getTeamName(e){const s=this.teams.find((s=>s.id==e));return s?s.name:""},getEmployeeName(e){const s=this.employees.find((s=>s.id==e));return s?s.name:""},formatDeadline(e){return new Date(e).toLocaleString("ru-RU")},getEnpsTemplate(){return[{id:1,type:"radio",question:"Укажите ваш формат работы:",options:["Офисный","Удаленный","Гибридный"],required:!0},{id:2,type:"textarea",question:"Какие шаги, по вашему мнению, компания могла бы предпринять для улучшения вашего опыта работы?",required:!1},{id:3,type:"scale",question:"Насколько вы удовлетворены своим опытом работы в компании?",scale:[1,2,3,4,5],required:!0},{id:4,type:"textarea",question:"Какие меры, на ваш взгляд, компания могла бы принять, чтобы вы охотнее рекомендовали ее своим друзьям как место для работы?",required:!1},{id:5,type:"scale",question:"Порекомендовали бы вы работать здесь своим друзьям?",scale:[1,2,3,4,5],required:!0},{id:6,type:"scale",question:"Чувствуете ли вы, что у вас есть возможность расти в этой компании?",scale:[1,2,3,4,5],required:!0},{id:7,type:"textarea",question:"Какие изменения, по вашему мнению, руководство могло бы внести для улучшения качества рабочих условий сотрудников?",required:!0},{id:8,type:"scale",question:"Считаете ли вы, что у вас есть все ресурсы и инструменты, необходимые для выполнения вашей работы эффективно?",scale:[1,2,3,4,5],required:!0},{id:9,type:"scale",question:"В какой степени вы чувствуете, что растете внутри компании как эксперт в своей области?",scale:[1,2,3,4,5],required:!0}]},get360Template(){return[{id:1,type:"text",question:"Имя",required:!0},{id:2,type:"textarea",question:"В чем заключаются ключевые личные, профессиональные и лидерские (если применимо) таланты сотрудника?",required:!1},{id:3,type:"textarea",question:"Каковы области личного, профессионального и лидерского (если применимо) совершенствования и развития сотрудника?",required:!1},{id:4,type:"textarea",question:"На основе ваших наблюдений приведите примеры того, как сотрудник развивается личностно, профессионально и как лидер (если применимо).",required:!1},{id:5,type:"textarea",question:"Другие комментарии",required:!1},{id:6,type:"matrix",question:"Оцените",required:!0,rows:["Межличностные: Предоставление обратной связи","Межличностные: Лидерство (если применимо)","Социальное: Эффективное общение","Решение проблем: Достижение результатов","Решение проблем: Движущая сила инноваций","Социальное: Сотрудничество (отношение к командной работе)","Профессионал: Ответственность и подотчетность","Профессионал: Профессиональная компетентность","Профессионал: Продуктивность и организация труда","Межличностные: Взаимное уважение"],scale:["Требует срочной корректировки","Требует улучшения","Соответствует занимаемой должности","Превосходит ожидания","Выдающийся результат"]}]},viewResults(e){this.$router.push(`/survey/${e}/results`)},async copySurveyLink(e){try{const s=`${window.location.origin}/survey/${e.access_token}`;await navigator.clipboard.writeText(s),alert("Ссылка скопирована в буфер обмена!")}catch(s){console.error("Error copying link:",s)}}}},he=t(1241);const ke=(0,he.A)(pe,[["render",ve],["__scopeId","data-v-4d1727b7"]]);var me=ke}}]);
//# sourceMappingURL=271.af103141.js.map