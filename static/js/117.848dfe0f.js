"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[117],{8117:function(e,t,n){n.r(t),n.d(t,{default:function(){return _e}});var i=n(6768),s=n(4232),o=n(5130);const l={class:"meeting-design-container"},a={key:0,class:"loading"},r={key:1,class:"error"},g={key:2},c={class:"action-buttons"},d={key:0,class:"no-designs"},u={key:1,class:"designs-grid"},k={class:"design-actions"},m=["onClick"],v=["onClick"],h=["onClick"],p={class:"modal create-modal"},D={class:"form-group"},L={class:"form-group"},b={value:"retrospective"},_={value:"planning"},$={value:"brainstorm"},w={value:"workshop"},y={value:"standup"},f={value:"review"},C={value:"kickoff"},E={value:"training"},B={class:"form-group"},x={class:"form-group"},M={value:"15"},X={value:"30"},I={value:"45"},A={value:"60"},V={value:"90"},U={value:"120"},S={value:"180"},P={value:"240"},W={value:"300"},T={value:"360"},z={value:"420"},F={value:"480"},J={value:"960"},G={class:"form-group"},R=["value"],K={class:"form-group"},Q={class:"constraint-labels"},j=["value"],N={class:"modal-buttons"},O=["disabled"],H={class:"modal view-modal"},q={class:"modal-header"},Y={class:"design-info"},Z={key:0},ee={class:"blocks-container"},te={class:"block-header"},ne={class:"block-time"},ie={class:"block-duration"},se={class:"block-actions"},oe=["onClick","disabled"],le=["onClick"],ae={class:"block-content"},re={class:"modal-buttons"},ge=["disabled"],ce={class:"modal edit-modal"},de={class:"form-group"},ue={class:"form-group"},ke={class:"form-group"},me={class:"form-group"},ve={class:"modal-buttons"};function he(e,t,n,he,pe,De){return(0,i.uX)(),(0,i.CE)("div",l,[(0,i.Lk)("h1",null,(0,s.v_)(e.$t("meetingDesign.title")),1),pe.loading?((0,i.uX)(),(0,i.CE)("div",a,"⏳ "+(0,s.v_)(e.$t("common.loading")),1)):pe.error?((0,i.uX)(),(0,i.CE)("div",r,"❌ "+(0,s.v_)(pe.error),1)):((0,i.uX)(),(0,i.CE)("div",g,[(0,i.Lk)("div",c,[(0,i.Lk)("button",{class:"create-btn",onClick:t[0]||(t[0]=e=>pe.showCreateModal=!0)}," ➕ "+(0,s.v_)(e.$t("meetingDesign.createNew")),1)]),0===pe.designs.length?((0,i.uX)(),(0,i.CE)("div",d,[(0,i.Lk)("p",null,(0,s.v_)(e.$t("meetingDesign.noDesigns")),1)])):((0,i.uX)(),(0,i.CE)("div",u,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(pe.designs,(t=>((0,i.uX)(),(0,i.CE)("div",{key:t.id,class:"design-card"},[(0,i.Lk)("h3",null,(0,s.v_)(t.title),1),(0,i.Lk)("p",null,[(0,i.Lk)("strong",null,(0,s.v_)(e.$t("meetingDesign.meetingType"))+":",1),(0,i.eW)(" "+(0,s.v_)(t.meeting_type),1)]),(0,i.Lk)("p",null,[(0,i.Lk)("strong",null,(0,s.v_)(e.$t("meetingDesign.duration"))+":",1),(0,i.eW)(" "+(0,s.v_)(t.duration_minutes)+" "+(0,s.v_)(e.$t("meetingDesign.minutes")),1)]),(0,i.Lk)("p",null,[(0,i.Lk)("strong",null,(0,s.v_)(e.$t("meetingDesign.goal"))+":",1),(0,i.eW)(" "+(0,s.v_)(t.goal.substring(0,100))+"...",1)]),(0,i.Lk)("div",k,[(0,i.Lk)("button",{class:"view-btn",onClick:e=>De.viewDesign(t)},"👁️ Просмотр",8,m),(0,i.Lk)("button",{class:"pdf-btn",onClick:e=>De.exportPdf(t.id)},"📄 PDF",8,v),(0,i.Lk)("button",{class:"delete-btn",onClick:e=>De.deleteDesign(t.id)},"🗑️ "+(0,s.v_)(e.$t("common.delete")),9,h)])])))),128))]))])),pe.showCreateModal?((0,i.uX)(),(0,i.CE)("div",{key:3,class:"modal-overlay",onClick:t[10]||(t[10]=(0,o.D$)((e=>pe.showCreateModal=!1),["self"]))},[(0,i.Lk)("div",p,[(0,i.Lk)("h2",null,(0,s.v_)(e.$t("meetingDesign.createNew")),1),(0,i.Lk)("div",D,[(0,i.Lk)("label",null,(0,s.v_)(e.$t("meetingDesign.meetingTitle")),1),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>pe.newDesign.title=e),type:"text",class:"form-input"},null,512),[[o.Jo,pe.newDesign.title]])]),(0,i.Lk)("div",L,[(0,i.Lk)("label",null,(0,s.v_)(e.$t("meetingDesign.meetingType")),1),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>pe.newDesign.meeting_type=e),class:"form-select"},[(0,i.Lk)("option",b,(0,s.v_)(e.$t("meetingDesign.types.retrospective")),1),(0,i.Lk)("option",_,(0,s.v_)(e.$t("meetingDesign.types.planning")),1),(0,i.Lk)("option",$,(0,s.v_)(e.$t("meetingDesign.types.brainstorm")),1),(0,i.Lk)("option",w,(0,s.v_)(e.$t("meetingDesign.types.workshop")),1),(0,i.Lk)("option",y,(0,s.v_)(e.$t("meetingDesign.types.standup")),1),(0,i.Lk)("option",f,(0,s.v_)(e.$t("meetingDesign.types.review")),1),(0,i.Lk)("option",C,(0,s.v_)(e.$t("meetingDesign.types.kickoff")),1),(0,i.Lk)("option",E,(0,s.v_)(e.$t("meetingDesign.types.training")),1)],512),[[o.u1,pe.newDesign.meeting_type]])]),(0,i.Lk)("div",B,[(0,i.Lk)("label",null,(0,s.v_)(e.$t("meetingDesign.goal")),1),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":t[3]||(t[3]=e=>pe.newDesign.goal=e),class:"form-textarea",rows:"3"},null,512),[[o.Jo,pe.newDesign.goal]])]),(0,i.Lk)("div",x,[(0,i.Lk)("label",null,(0,s.v_)(e.$t("meetingDesign.duration")),1),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>pe.newDesign.duration_minutes=e),class:"form-select"},[(0,i.Lk)("option",M,"15 "+(0,s.v_)(e.$t("meetingDesign.minutes")),1),(0,i.Lk)("option",X,"30 "+(0,s.v_)(e.$t("meetingDesign.minutes")),1),(0,i.Lk)("option",I,"45 "+(0,s.v_)(e.$t("meetingDesign.minutes")),1),(0,i.Lk)("option",A,"1 "+(0,s.v_)(e.$t("meetingDesign.hours")),1),(0,i.Lk)("option",V,"1.5 "+(0,s.v_)(e.$t("meetingDesign.hours")),1),(0,i.Lk)("option",U,"2 "+(0,s.v_)(e.$t("meetingDesign.hours")),1),(0,i.Lk)("option",S,"3 "+(0,s.v_)(e.$t("meetingDesign.hours")),1),(0,i.Lk)("option",P,"4 "+(0,s.v_)(e.$t("meetingDesign.hours")),1),(0,i.Lk)("option",W,"5 "+(0,s.v_)(e.$t("meetingDesign.hours")),1),(0,i.Lk)("option",T,"6 "+(0,s.v_)(e.$t("meetingDesign.hours")),1),(0,i.Lk)("option",z,"7 "+(0,s.v_)(e.$t("meetingDesign.hours")),1),(0,i.Lk)("option",F,"8 "+(0,s.v_)(e.$t("meetingDesign.hours")),1),(0,i.Lk)("option",J,"16 "+(0,s.v_)(e.$t("meetingDesign.hours")),1)],512),[[o.u1,pe.newDesign.duration_minutes]])]),(0,i.Lk)("div",G,[(0,i.Lk)("label",null,(0,s.v_)(e.$t("meetingDesign.selectTeam")),1),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>pe.newDesign.team_id=e),class:"form-select"},[t[22]||(t[22]=(0,i.Lk)("option",{value:""},"Без команды",-1)),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(pe.teams,(e=>((0,i.uX)(),(0,i.CE)("option",{key:e.id,value:e.id},(0,s.v_)(e.name),9,R)))),128))],512),[[o.u1,pe.newDesign.team_id]])]),(0,i.Lk)("div",K,[(0,i.Lk)("label",null,(0,s.v_)(e.$t("meetingDesign.constraints")),1),(0,i.Lk)("div",Q,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(pe.constraintLabels,((e,n)=>((0,i.uX)(),(0,i.CE)("label",{key:n,class:"constraint-label"},[(0,i.bo)((0,i.Lk)("input",{type:"checkbox",value:n,"onUpdate:modelValue":t[6]||(t[6]=e=>pe.selectedConstraints=e)},null,8,j),[[o.lH,pe.selectedConstraints]]),(0,i.eW)(" "+(0,s.v_)(e),1)])))),128))]),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":t[7]||(t[7]=e=>pe.newDesign.constraints=e),class:"form-textarea",rows:"2",placeholder:"Дополнительные ограничения..."},null,512),[[o.Jo,pe.newDesign.constraints]])]),(0,i.Lk)("div",N,[(0,i.Lk)("button",{class:"confirm-btn",onClick:t[8]||(t[8]=(...e)=>De.generateDesign&&De.generateDesign(...e)),disabled:pe.generating},(0,s.v_)(pe.generating?e.$t("meetingDesign.creating"):e.$t("meetingDesign.generate")),9,O),(0,i.Lk)("button",{class:"cancel-btn",onClick:t[9]||(t[9]=(...e)=>De.closeCreateModal&&De.closeCreateModal(...e))},(0,s.v_)(e.$t("common.cancel")),1)])])])):(0,i.Q3)("",!0),pe.showViewModal&&pe.currentDesign?((0,i.uX)(),(0,i.CE)("div",{key:4,class:"modal-overlay",onClick:t[14]||(t[14]=(0,o.D$)((e=>pe.showViewModal=!1),["self"]))},[(0,i.Lk)("div",H,[(0,i.Lk)("div",q,[(0,i.Lk)("h2",null,(0,s.v_)(pe.currentDesign.title),1),(0,i.Lk)("button",{class:"close-btn",onClick:t[11]||(t[11]=e=>pe.showViewModal=!1)},"✕")]),(0,i.Lk)("div",Y,[(0,i.Lk)("p",null,[(0,i.Lk)("strong",null,(0,s.v_)(e.$t("meetingDesign.meetingType"))+":",1),(0,i.eW)(" "+(0,s.v_)(pe.currentDesign.meeting_type),1)]),(0,i.Lk)("p",null,[(0,i.Lk)("strong",null,(0,s.v_)(e.$t("meetingDesign.goal"))+":",1),(0,i.eW)(" "+(0,s.v_)(pe.currentDesign.goal),1)]),(0,i.Lk)("p",null,[(0,i.Lk)("strong",null,(0,s.v_)(e.$t("meetingDesign.duration"))+":",1),(0,i.eW)(" "+(0,s.v_)(pe.currentDesign.duration_minutes)+" "+(0,s.v_)(e.$t("meetingDesign.minutes")),1)]),pe.currentDesign.constraints?((0,i.uX)(),(0,i.CE)("p",Z,[(0,i.Lk)("strong",null,(0,s.v_)(e.$t("meetingDesign.constraints"))+":",1),(0,i.eW)(" "+(0,s.v_)(pe.currentDesign.constraints),1)])):(0,i.Q3)("",!0)]),(0,i.Lk)("div",ee,[(0,i.Lk)("h3",null,(0,s.v_)(e.$t("meetingDesign.blocks")),1),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(pe.currentDesign.blocks,((t,n)=>((0,i.uX)(),(0,i.CE)("div",{key:n,class:"block-card"},[(0,i.Lk)("div",te,[(0,i.Lk)("div",ne,[(0,i.Lk)("strong",null,(0,s.v_)(t.time),1),(0,i.eW)(" - "+(0,s.v_)(t.title)+" ",1),(0,i.Lk)("span",ie,"("+(0,s.v_)(t.duration)+" мин)",1)]),(0,i.Lk)("div",se,[(0,i.Lk)("button",{class:"regenerate-btn",onClick:e=>De.regenerateBlock(n),disabled:pe.regenerating===n},(0,s.v_)(pe.regenerating===n?e.$t("meetingDesign.regenerating"):"🔄"),9,oe),(0,i.Lk)("button",{class:"edit-btn",onClick:e=>De.editBlock(n)},"✏️",8,le)])]),(0,i.Lk)("div",ae,[(0,i.Lk)("p",null,(0,s.v_)(t.description),1)])])))),128))]),(0,i.Lk)("div",re,[(0,i.Lk)("button",{class:"pdf-btn",onClick:t[12]||(t[12]=e=>De.exportPdf(pe.currentDesign.id))},"📄 "+(0,s.v_)(e.$t("meetingDesign.exportPdf")),1),(0,i.Lk)("button",{class:"save-btn",onClick:t[13]||(t[13]=(...e)=>De.saveDesign&&De.saveDesign(...e)),disabled:pe.saving},(0,s.v_)(pe.saving?e.$t("meetingDesign.saving"):e.$t("meetingDesign.save")),9,ge)])])])):(0,i.Q3)("",!0),pe.showEditModal&&pe.editingBlock?((0,i.uX)(),(0,i.CE)("div",{key:5,class:"modal-overlay",onClick:t[21]||(t[21]=(0,o.D$)((e=>pe.showEditModal=!1),["self"]))},[(0,i.Lk)("div",ce,[t[27]||(t[27]=(0,i.Lk)("h2",null,"Редактировать блок",-1)),(0,i.Lk)("div",de,[t[23]||(t[23]=(0,i.Lk)("label",null,"Название",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[15]||(t[15]=e=>pe.editingBlock.title=e),type:"text",class:"form-input"},null,512),[[o.Jo,pe.editingBlock.title]])]),(0,i.Lk)("div",ue,[t[24]||(t[24]=(0,i.Lk)("label",null,"Время",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[16]||(t[16]=e=>pe.editingBlock.time=e),type:"text",class:"form-input"},null,512),[[o.Jo,pe.editingBlock.time]])]),(0,i.Lk)("div",ke,[t[25]||(t[25]=(0,i.Lk)("label",null,"Продолжительность (минуты)",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[17]||(t[17]=e=>pe.editingBlock.duration=e),type:"number",class:"form-input"},null,512),[[o.Jo,pe.editingBlock.duration]])]),(0,i.Lk)("div",me,[t[26]||(t[26]=(0,i.Lk)("label",null,"Описание",-1)),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":t[18]||(t[18]=e=>pe.editingBlock.description=e),class:"form-textarea",rows:"4"},null,512),[[o.Jo,pe.editingBlock.description]])]),(0,i.Lk)("div",ve,[(0,i.Lk)("button",{class:"confirm-btn",onClick:t[19]||(t[19]=(...e)=>De.saveBlockEdit&&De.saveBlockEdit(...e))},(0,s.v_)(e.$t("common.save")),1),(0,i.Lk)("button",{class:"cancel-btn",onClick:t[20]||(t[20]=e=>pe.showEditModal=!1)},(0,s.v_)(e.$t("common.cancel")),1)])])])):(0,i.Q3)("",!0)])}n(8111),n(2489),n(1701),n(4603),n(7566),n(8721);var pe=n(4373),De={name:"MeetingDesign",data(){return{designs:[],teams:[],loading:!0,error:null,showCreateModal:!1,showViewModal:!1,showEditModal:!1,generating:!1,saving:!1,regenerating:null,currentDesign:null,editingBlock:null,editingBlockIndex:null,selectedConstraints:[],newDesign:{title:"",meeting_type:"retrospective",goal:"",duration_minutes:60,team_id:"",constraints:""},constraintLabels:{remote:this.$t("meetingDesign.constraintLabels.remote"),inPerson:this.$t("meetingDesign.constraintLabels.inPerson"),hybrid:this.$t("meetingDesign.constraintLabels.hybrid"),largeGroup:this.$t("meetingDesign.constraintLabels.largeGroup"),smallGroup:this.$t("meetingDesign.constraintLabels.smallGroup"),timeboxed:this.$t("meetingDesign.constraintLabels.timeboxed"),interactive:this.$t("meetingDesign.constraintLabels.interactive"),presentation:this.$t("meetingDesign.constraintLabels.presentation")}}},async mounted(){await this.loadDesigns(),await this.loadTeams()},methods:{async loadDesigns(){try{this.loading=!0;const e=localStorage.getItem("token"),t=await pe.A.get("/api/meeting-design",{headers:{Authorization:`Bearer ${e}`}});this.designs=t.data}catch(e){console.error("Error loading designs:",e),this.error=this.$t("meetingDesign.errorLoading")}finally{this.loading=!1}},async loadTeams(){try{const e=localStorage.getItem("token"),t=await pe.A.get("/api/teams",{headers:{Authorization:`Bearer ${e}`}});this.teams=t.data}catch(e){console.error("Error loading teams:",e)}},async generateDesign(){try{this.generating=!0;const e=localStorage.getItem("token"),t=this.selectedConstraints.length>0?this.selectedConstraints.map((e=>this.constraintLabels[e])).join(", ")+(this.newDesign.constraints?". "+this.newDesign.constraints:""):this.newDesign.constraints,n={...this.newDesign,constraints:t,team_id:this.newDesign.team_id||null},i=await pe.A.post("/api/meeting-design/generate",n,{headers:{Authorization:`Bearer ${e}`}});this.designs.unshift(i.data),this.closeCreateModal(),this.viewDesign(i.data)}catch(e){console.error("Error generating design:",e),this.error=this.$t("meetingDesign.errorGenerating")}finally{this.generating=!1}},async regenerateBlock(e){try{this.regenerating=e;const t=localStorage.getItem("token"),n=await pe.A.post("/api/meeting-design/regenerate-block",{design_id:this.currentDesign.id,block_index:e},{headers:{Authorization:`Bearer ${t}`}});this.currentDesign.blocks[e]=n.data.block;const i=this.designs.findIndex((e=>e.id===this.currentDesign.id));-1!==i&&(this.designs[i]=n.data.design)}catch(t){console.error("Error regenerating block:",t),this.error=this.$t("meetingDesign.errorRegenerating")}finally{this.regenerating=null}},async saveDesign(){try{this.saving=!0;const e=localStorage.getItem("token");await pe.A.put(`/api/meeting-design/${this.currentDesign.id}`,{title:this.currentDesign.title,goal:this.currentDesign.goal,constraints:this.currentDesign.constraints,blocks:this.currentDesign.blocks},{headers:{Authorization:`Bearer ${e}`}}),alert(this.$t("meetingDesign.designSaved"))}catch(e){console.error("Error saving design:",e),this.error=this.$t("meetingDesign.errorSaving")}finally{this.saving=!1}},async deleteDesign(e){if(confirm(this.$t("meetingDesign.confirmDelete")))try{const t=localStorage.getItem("token");await pe.A.delete(`/api/meeting-design/${e}`,{headers:{Authorization:`Bearer ${t}`}}),this.designs=this.designs.filter((t=>t.id!==e)),alert(this.$t("meetingDesign.designDeleted"))}catch(t){console.error("Error deleting design:",t),this.error=this.$t("meetingDesign.errorSaving")}},async exportPdf(e){try{const t=localStorage.getItem("token"),n=await pe.A.get(`/api/meeting-design/${e}/pdf`,{headers:{Authorization:`Bearer ${t}`},responseType:"blob"}),i=window.URL.createObjectURL(new Blob([n.data])),s=document.createElement("a");s.href=i,s.setAttribute("download",`meeting-design-${e}.pdf`),document.body.appendChild(s),s.click(),s.remove(),window.URL.revokeObjectURL(i)}catch(t){console.error("Error exporting PDF:",t),this.error="Ошибка экспорта PDF"}},viewDesign(e){this.currentDesign={...e},this.showViewModal=!0},editBlock(e){this.editingBlock={...this.currentDesign.blocks[e]},this.editingBlockIndex=e,this.showEditModal=!0},saveBlockEdit(){this.currentDesign.blocks[this.editingBlockIndex]={...this.editingBlock},this.showEditModal=!1,this.editingBlock=null,this.editingBlockIndex=null},closeCreateModal(){this.showCreateModal=!1,this.newDesign={title:"",meeting_type:"retrospective",goal:"",duration_minutes:60,team_id:"",constraints:""},this.selectedConstraints=[]}}},Le=n(1241);const be=(0,Le.A)(De,[["render",he],["__scopeId","data-v-b2c2a87a"]]);var _e=be}}]);
//# sourceMappingURL=117.848dfe0f.js.map