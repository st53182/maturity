"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[807],{5807:function(t,e,o){o.r(e),o.d(e,{default:function(){return v}});var a=o(6768),n=o(4232),i=o(5130);const l={class:"conflict-container"},s={class:"filter-bar"},c=["onClick"],r={class:"conflict-list"},u=["onClick"],d=["onClick"],f={key:0,class:"modal-overlay"},p={class:"modal-content"},k=["value"],h={class:"modal-actions"},m=["disabled"],C=["innerHTML"];function y(t,e,o,y,L,b){return(0,a.uX)(),(0,a.CE)("div",l,[e[15]||(e[15]=(0,a.Lk)("h1",null,"ðŸ”¥ ÐšÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚Ñ‹ Ð² ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°Ñ…",-1)),(0,a.Lk)("div",s,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(L.statuses,(t=>((0,a.uX)(),(0,a.CE)("button",{key:t,class:(0,n.C4)({active:L.filterStatus===t}),onClick:e=>L.filterStatus=t},(0,n.v_)(t),11,c)))),128)),(0,a.Lk)("button",{onClick:e[0]||(e[0]=t=>b.openModal(null)),class:"add-btn"},"âž• ÐÐ¾Ð²Ñ‹Ð¹ ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚")]),(0,a.Lk)("div",r,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(b.filteredConflicts,(t=>((0,a.uX)(),(0,a.CE)("div",{key:t.id,class:"conflict-card"},[(0,a.Lk)("h3",null,"ðŸ§  "+(0,n.v_)(t.context.slice(0,100))+"...",1),(0,a.Lk)("p",null,"ðŸ‘¥ Ð£Ñ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¸: "+(0,n.v_)(b.getParticipantNames(t.participants)),1),(0,a.Lk)("p",null,"ðŸŽ¯ Ð¦ÐµÐ»ÑŒ: "+(0,n.v_)(t.goal),1),(0,a.Lk)("p",null,[e[8]||(e[8]=(0,a.eW)("ðŸ“Œ Ð¡Ñ‚Ð°Ñ‚ÑƒÑ: ")),(0,a.Lk)("strong",null,(0,n.v_)(t.status),1)]),(0,a.Lk)("button",{onClick:e=>b.openModal(t)},"âœï¸ Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ",8,u),(0,a.Lk)("button",{class:"delete-btn",onClick:e=>b.deleteConflict(t.id)},"ðŸ—‘",8,d)])))),128))]),L.showModal?((0,a.uX)(),(0,a.CE)("div",f,[(0,a.Lk)("div",p,[(0,a.Lk)("h2",null,(0,n.v_)(L.form.id?"Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ":"ÐÐ¾Ð²Ñ‹Ð¹ ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚"),1),e[10]||(e[10]=(0,a.Lk)("label",null,"ÐšÐ¾Ð½Ñ‚ÐµÐºÑÑ‚ ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚Ð°",-1)),(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":e[1]||(e[1]=t=>L.form.context=t),rows:"3"},null,512),[[i.Jo,L.form.context]]),e[11]||(e[11]=(0,a.Lk)("label",null,"Ð£Ñ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¸",-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>L.form.participants=t),multiple:""},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(L.employees,(t=>((0,a.uX)(),(0,a.CE)("option",{value:t.id,key:t.id},(0,n.v_)(t.name),9,k)))),128))],512),[[i.u1,L.form.participants]]),e[12]||(e[12]=(0,a.Lk)("label",null,"Ð§Ñ‚Ð¾ Ð¿Ñ€ÐµÐ´Ð¿Ñ€Ð¸Ð½Ð¸Ð¼Ð°Ð»Ð¾ÑÑŒ?",-1)),(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":e[3]||(e[3]=t=>L.form.actions_taken=t),rows:"2"},null,512),[[i.Jo,L.form.actions_taken]]),e[13]||(e[13]=(0,a.Lk)("label",null,"Ð¦ÐµÐ»ÑŒ Ñ€Ð°Ð·Ñ€ÐµÑˆÐµÐ½Ð¸Ñ",-1)),(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":e[4]||(e[4]=t=>L.form.goal=t),rows:"2"},null,512),[[i.Jo,L.form.goal]]),e[14]||(e[14]=(0,a.Lk)("label",null,"Ð¡Ñ‚Ð°Ñ‚ÑƒÑ",-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":e[5]||(e[5]=t=>L.form.status=t)},e[9]||(e[9]=[(0,a.Lk)("option",{value:"ÐÐºÑ‚Ð¸Ð²ÐµÐ½"},"ÐÐºÑ‚Ð¸Ð²ÐµÐ½",-1),(0,a.Lk)("option",{value:"Ð—Ð°ÐºÑ€Ñ‹Ñ‚"},"Ð—Ð°ÐºÑ€Ñ‹Ñ‚",-1),(0,a.Lk)("option",{value:"ÐžÐ±Ð¾ÑÑ‚Ñ€ÐµÐ½Ð¸Ðµ"},"ÐžÐ±Ð¾ÑÑ‚Ñ€ÐµÐ½Ð¸Ðµ",-1)]),512),[[i.u1,L.form.status]]),(0,a.Lk)("div",h,[(0,a.Lk)("button",{onClick:e[6]||(e[6]=(...t)=>b.submitConflict&&b.submitConflict(...t)),disabled:t.loading},(0,n.v_)(t.loading?"ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ°...":"ðŸ’¬ ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸"),9,m),(0,a.Lk)("button",{class:"modal-close",onClick:e[7]||(e[7]=t=>L.showModal=!1)},"âœ–")]),L.form.ai_response?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"ai-analysis",innerHTML:L.form.ai_response},null,8,C)):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)])}o(4114),o(8111),o(2489),o(1701);var L={data(){return{conflicts:[],employees:[],showModal:!1,filterStatus:"Ð’ÑÐµ",statuses:["Ð’ÑÐµ","ÐÐºÑ‚Ð¸Ð²ÐµÐ½","Ð—Ð°ÐºÑ€Ñ‹Ñ‚","ÐžÐ±Ð¾ÑÑ‚Ñ€ÐµÐ½Ð¸Ðµ"],form:{id:null,context:"",participants:[],actions_taken:"",goal:"",status:"ÐÐºÑ‚Ð¸Ð²ÐµÐ½",ai_response:"",loading:!1}}},computed:{filteredConflicts(){return"Ð’ÑÐµ"===this.filterStatus?this.conflicts:this.conflicts.filter((t=>t.status===this.filterStatus))}},methods:{async fetchConflicts(){const t=localStorage.getItem("token"),e=await fetch("/api/conflicts",{headers:{Authorization:`Bearer ${t}`}});this.conflicts=await e.json()},async fetchEmployees(){const t=localStorage.getItem("token"),e=await fetch("/employees",{headers:{Authorization:`Bearer ${t}`}}),o=e.headers.get("content-type");if(e.ok&&o&&o.includes("application/json"))this.employees=await e.json();else{const t=await e.text();console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐµ ÑÐ¾Ñ‚Ñ€ÑƒÐ´Ð½Ð¸ÐºÐ¾Ð²:",t)}},getParticipantNames(t){try{const e=Array.isArray(t)?t:JSON.parse(t);return this.employees.filter((t=>e.includes(t.id))).map((t=>t.name)).join(", ")}catch(e){return"â€”"}},openModal(t){if(t){this.form={...t};try{this.form.participants=JSON.parse(t.participants||"[]")}catch(e){this.form.participants=[]}}else this.form={id:null,context:"",participants:[],actions_taken:"",goal:"",status:"ÐÐºÑ‚Ð¸Ð²ÐµÐ½",ai_response:""};this.showModal=!0},async deleteConflict(t){const e=localStorage.getItem("token");await fetch(`/api/conflict/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${e}`}}),await this.fetchConflicts()},async submitConflict(){const t=localStorage.getItem("token"),e={...this.form};let o;e.participants=JSON.stringify(e.participants),e.attempts=e.actions_taken,delete e.actions_taken,o=this.form.id?await fetch(`/api/conflict/${this.form.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(e)}):await fetch("/api/conflicts",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(e)});const a=await o.json();o.ok?(this.form.ai_response=a.analysis,await this.fetchConflicts()):alert(a.error||"ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ð¸ ÐºÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚Ð°")},async waitForTokenAndInit(){let t=10;while(!localStorage.getItem("token")&&t>0)await new Promise((t=>setTimeout(t,300))),t--;const e=localStorage.getItem("token");e?(await this.fetchConflicts(),await this.fetchEmployees()):this.$router.push("/login")}},mounted(){this.waitForTokenAndInit()}},b=o(1241);const g=(0,b.A)(L,[["render",y],["__scopeId","data-v-9c21f7f0"]]);var v=g}}]);
//# sourceMappingURL=807.15e493c8.js.map