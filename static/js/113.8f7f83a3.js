"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[113],{2113:function(e,s,t){t.r(s),t.d(s,{default:function(){return D}});var r=t(6436),n=t(7959),u=t(1469);const i={class:"take-survey-container"},a={key:0,class:"loading"},o={key:1,class:"error"},l={key:2,class:"success"},c={key:3,class:"survey-form"},d={class:"survey-header"},v={class:"survey-info"},y={class:"survey-type"},p={key:0,class:"deadline"},Q={class:"progress-bar"},k={class:"question-container"},b={key:0,class:"question"},h=["required"],m=["required"],w={key:2,class:"radio-options"},x=["value","required"],C={key:3,class:"scale-options"},E={class:"scale-buttons"},f=["onClick"],L={key:4,class:"matrix-rating"},X={class:"matrix-header"},q={class:"matrix-scale-labels"},g={class:"row-label"},I={class:"row-options"},A=["name","value","onUpdate:modelValue"],_={class:"navigation-buttons"},j=["disabled"],S=["disabled"];function U(e,s,t,U,$,F){return(0,r.uX)(),(0,r.CE)("div",i,[$.loading?((0,r.uX)(),(0,r.CE)("div",a,"⏳ Загрузка опросника...")):$.error?((0,r.uX)(),(0,r.CE)("div",o,"❌ "+(0,n.v_)($.error),1)):$.submitted?((0,r.uX)(),(0,r.CE)("div",l,s[6]||(s[6]=[(0,r.Lk)("h2",null,"✅ Спасибо за участие!",-1),(0,r.Lk)("p",null,"Ваши ответы успешно отправлены.",-1)]))):((0,r.uX)(),(0,r.CE)("div",c,[(0,r.Lk)("div",d,[(0,r.Lk)("h1",null,(0,n.v_)($.survey.title),1),(0,r.Lk)("div",v,[(0,r.Lk)("span",y,(0,n.v_)($.survey.survey_type.toUpperCase()),1),$.survey.deadline?((0,r.uX)(),(0,r.CE)("span",p," Срок: "+(0,n.v_)(F.formatDate($.survey.deadline)),1)):(0,r.Q3)("",!0)])]),(0,r.Lk)("div",Q,[(0,r.Lk)("div",{class:"progress",style:(0,n.Tr)({width:F.progressPercent+"%"})},null,4)]),(0,r.Lk)("div",k,[F.currentQuestion?((0,r.uX)(),(0,r.CE)("div",b,[(0,r.Lk)("h3",null,(0,n.v_)(F.currentQuestion.question),1),"text"===F.currentQuestion.type?(0,r.bo)(((0,r.uX)(),(0,r.CE)("input",{key:0,"onUpdate:modelValue":s[0]||(s[0]=e=>$.answers[F.currentQuestion.id]=e),type:"text",class:"text-input",required:F.currentQuestion.required},null,8,h)),[[u.Jo,$.answers[F.currentQuestion.id]]]):(0,r.Q3)("",!0),"textarea"===F.currentQuestion.type?(0,r.bo)(((0,r.uX)(),(0,r.CE)("textarea",{key:1,"onUpdate:modelValue":s[1]||(s[1]=e=>$.answers[F.currentQuestion.id]=e),class:"textarea-input",rows:"4",required:F.currentQuestion.required},null,8,m)),[[u.Jo,$.answers[F.currentQuestion.id]]]):(0,r.Q3)("",!0),"radio"===F.currentQuestion.type?((0,r.uX)(),(0,r.CE)("div",w,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(F.currentQuestion.options,(e=>((0,r.uX)(),(0,r.CE)("label",{key:"object"===typeof e?e.value:e,class:"radio-label"},[(0,r.bo)((0,r.Lk)("input",{type:"radio",value:"object"===typeof e?e.value:e,"onUpdate:modelValue":s[2]||(s[2]=e=>$.answers[F.currentQuestion.id]=e),required:F.currentQuestion.required},null,8,x),[[u.XL,$.answers[F.currentQuestion.id]]]),(0,r.Lk)("span",null,(0,n.v_)("object"===typeof e?e.text:e),1)])))),128))])):(0,r.Q3)("",!0),"scale"===F.currentQuestion.type?((0,r.uX)(),(0,r.CE)("div",C,[s[7]||(s[7]=(0,r.Lk)("div",{class:"scale-labels"},[(0,r.Lk)("span",null,"1 (Низко)"),(0,r.Lk)("span",null,"5 (Высоко)")],-1)),(0,r.Lk)("div",E,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(F.currentQuestion.scale,(e=>((0,r.uX)(),(0,r.CE)("button",{key:e,class:(0,n.C4)([{active:$.answers[F.currentQuestion.id]==e},"scale-btn"]),onClick:s=>$.answers[F.currentQuestion.id]=e},(0,n.v_)(e),11,f)))),128))])])):(0,r.Q3)("",!0),"matrix"===F.currentQuestion.type?((0,r.uX)(),(0,r.CE)("div",L,[(0,r.Lk)("div",X,[(0,r.Lk)("div",q,[s[8]||(s[8]=(0,r.Lk)("span",{class:"empty-cell"},null,-1)),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(F.currentQuestion.columns||F.currentQuestion.scale||[],((e,s)=>((0,r.uX)(),(0,r.CE)("span",{key:s,class:"scale-label"},(0,n.v_)("object"===typeof e?e.text:e),1)))),128))])]),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(F.currentQuestion.rows||[],((e,t)=>((0,r.uX)(),(0,r.CE)("div",{key:t,class:"matrix-row"},[(0,r.Lk)("div",g,(0,n.v_)("object"===typeof e?e.text:e),1),(0,r.Lk)("div",I,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(F.currentQuestion.columns||F.currentQuestion.scale||[],((n,i)=>((0,r.uX)(),(0,r.CE)("label",{key:i,class:"matrix-option"},[(0,r.bo)((0,r.Lk)("input",{type:"radio",name:`matrix_${F.currentQuestion.id}_${t}`,value:"object"===typeof n?n.value:n,"onUpdate:modelValue":s=>$.matrixAnswers[F.currentQuestion.id]["object"===typeof e?e.value:e]=s},null,8,A),[[u.XL,$.matrixAnswers[F.currentQuestion.id]["object"===typeof e?e.value:e]]]),s[9]||(s[9]=(0,r.Lk)("span",{class:"radio-custom"},null,-1))])))),128))])])))),128))])):(0,r.Q3)("",!0)])):(0,r.Q3)("",!0),(0,r.Lk)("div",_,[$.currentQuestionIndex>0?((0,r.uX)(),(0,r.CE)("button",{key:0,onClick:s[3]||(s[3]=(...e)=>F.previousQuestion&&F.previousQuestion(...e)),class:"nav-btn prev-btn"}," ← Назад ")):(0,r.Q3)("",!0),$.currentQuestionIndex<$.survey.questions.length-1?((0,r.uX)(),(0,r.CE)("button",{key:1,onClick:s[4]||(s[4]=(...e)=>F.nextQuestion&&F.nextQuestion(...e)),class:"nav-btn next-btn",disabled:!F.isCurrentQuestionAnswered}," Далее → ",8,j)):(0,r.Q3)("",!0),$.currentQuestionIndex===$.survey.questions.length-1?((0,r.uX)(),(0,r.CE)("button",{key:2,onClick:s[5]||(s[5]=(...e)=>F.submitSurvey&&F.submitSurvey(...e)),class:"nav-btn submit-btn",disabled:!F.allRequiredAnswered}," Отправить ответы ",8,S)):(0,r.Q3)("",!0)])])]))])}t(8111),t(1148),t(7588);var $=t(8207),F={name:"SurveyTaker",data(){return{survey:null,loading:!0,error:null,submitted:!1,currentQuestionIndex:0,answers:{},matrixAnswers:{}}},computed:{currentQuestion(){return this.survey?.questions[this.currentQuestionIndex]},progressPercent(){return this.survey?(this.currentQuestionIndex+1)/this.survey.questions.length*100:0},isCurrentQuestionAnswered(){const e=this.currentQuestion;if(!e)return!1;if("matrix"===e.type){const s=this.matrixAnswers[e.id]||{};return!e.required||e.rows.every((e=>s[e]))}return!e.required||void 0!==this.answers[e.id]&&""!==this.answers[e.id]},allRequiredAnswered(){return this.survey?.questions.every((e=>{if(!e.required)return!0;if("matrix"===e.type){const s=this.matrixAnswers[e.id]||{};return e.rows.every((e=>s[e]))}return void 0!==this.answers[e.id]&&""!==this.answers[e.id]}))}},async mounted(){await this.loadSurvey()},methods:{async loadSurvey(){try{const e=this.$route.params.token,s=await $.A.get(`/api/survey/${e}`);this.survey=s.data,this.survey.questions.forEach((e=>{"matrix"===e.type&&(this.matrixAnswers[e.id]={})}))}catch(e){console.error("Error loading survey:",e),this.error=e.response?.data?.error||"Ошибка загрузки опросника"}finally{this.loading=!1}},nextQuestion(){this.currentQuestionIndex<this.survey.questions.length-1&&this.currentQuestionIndex++},previousQuestion(){this.currentQuestionIndex>0&&this.currentQuestionIndex--},async submitSurvey(){try{const e=this.$route.params.token,s={...this.answers};Object.keys(this.matrixAnswers).forEach((e=>{s[e]=this.matrixAnswers[e]})),await $.A.post(`/api/survey/${e}/submit`,{answers:s,respondent_name:this.answers[1]}),this.submitted=!0}catch(e){console.error("Error submitting survey:",e),alert("Ошибка отправки ответов")}},formatDate(e){return new Date(e).toLocaleDateString("ru-RU")}}},K=t(5932);const V=(0,K.A)(F,[["render",U],["__scopeId","data-v-5cd59798"]]);var D=V}}]);
//# sourceMappingURL=113.8f7f83a3.js.map