"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[146],{146:function(e,a,t){t.r(a),t.d(a,{default:function(){return j}});var l=t(6768),o=t(4232),s=t(5130);const r={class:"motivation-container"},i={class:"employee-list"},n=["onClick"],c=["src","onClick"],m={class:"card-header"},d={class:"employee-name"},u=["onClick"],p={class:"team-name"},h={class:"disc-type-full"},k={class:"employee-card-footer"},v=["onClick"],y={key:0,class:"factors"},f={class:"column"},L={class:"column"},g=["innerHTML"],C={key:0,class:"modal-overlay"},b={class:"modal-content"},E=["value"],A={class:"modal-actions"},_=["disabled"],M=["disabled"],w={key:0},x={key:1},I={key:1,class:"modal-overlay"},T={class:"modal-content avatar-modal"},S={class:"avatar-section"},X={class:"avatar-grid"},F=["src","onClick"],D={class:"avatar-section"},$={class:"avatar-grid"},U=["src","onClick"];function q(e,a,t,q,J,K){return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("div",r,[a[20]||(a[20]=(0,l.Lk)("h1",null,"üéØ –ú–æ—Ç–∏–≤–∞—Ü–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞",-1)),(0,l.Lk)("div",i,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(J.employees,(e=>((0,l.uX)(),(0,l.CE)("div",{key:e.id,class:"employee-card",onClick:a=>K.selectEmployee(e)},[(0,l.Lk)("img",{class:"avatar",src:K.getAvatarUrl(e),alt:"avatar",onClick:a=>K.openAvatarModal(e),onError:a[0]||(a[0]=(...e)=>K.setDefaultAvatar&&K.setDefaultAvatar(...e))},null,40,c),(0,l.Lk)("div",m,[(0,l.Lk)("h4",d,(0,o.v_)(e.name),1),(0,l.Lk)("button",{class:"delete-btn",onClick:(0,s.D$)((a=>K.deleteEmployee(e.id)),["stop"])},"üóë",8,u)]),(0,l.Lk)("p",p,[a[14]||(a[14]=(0,l.eW)("üè¢ –ö–æ–º–∞–Ω–¥–∞: ")),(0,l.Lk)("strong",null,(0,o.v_)(K.getTeamName(e.team_id)||"‚Äî"),1)]),(0,l.Lk)("p",h,[a[15]||(a[15]=(0,l.eW)("üß† –¢–∏–ø DISC: ")),(0,l.Lk)("strong",null,(0,o.v_)(K.extractDISCFullType(e.ai_analysis)),1)]),(0,l.Lk)("div",k,[(0,l.Lk)("button",{class:"update-btn",onClick:a=>K.handleEmployeeClick(e)}," üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ ",8,v)]),e.ai_analysis?((0,l.uX)(),(0,l.CE)("div",y,[(0,l.Lk)("div",f,[a[16]||(a[16]=(0,l.Lk)("h5",null,"‚¨ÜÔ∏è –ú–æ—Ç–∏–≤–∞—Ç–æ—Ä—ã",-1)),(0,l.Lk)("ul",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.motivators,(e=>((0,l.uX)(),(0,l.CE)("li",{key:e},(0,o.v_)(e),1)))),128))])]),(0,l.Lk)("div",L,[a[17]||(a[17]=(0,l.Lk)("h5",null,"‚¨áÔ∏è –î–µ–º–æ—Ç–∏–≤–∞—Ç–æ—Ä—ã",-1)),(0,l.Lk)("ul",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.demotivators,(e=>((0,l.uX)(),(0,l.CE)("li",{key:e},(0,o.v_)(e),1)))),128))])])])):(0,l.Q3)("",!0),e.ai_analysis?((0,l.uX)(),(0,l.CE)("div",{key:1,class:"manager-tips-block",innerHTML:K.extractManagerTips(e.ai_analysis)},null,8,g)):(0,l.Q3)("",!0),a[18]||(a[18]=(0,l.Lk)("div",{class:"form-footer"},null,-1))],8,n)))),128)),(0,l.Lk)("div",{class:"employee-card add-card",onClick:a[1]||(a[1]=(...e)=>K.resetForm&&K.resetForm(...e))},a[19]||(a[19]=[(0,l.Lk)("span",null,"‚ûï",-1),(0,l.Lk)("p",null,"–°–æ–∑–¥–∞—Ç—å",-1)]))])]),J.showModal?((0,l.uX)(),(0,l.CE)("div",C,[(0,l.Lk)("div",b,[(0,l.Lk)("form",{onSubmit:a[12]||(a[12]=(0,s.D$)(((...e)=>K.submitMotivation&&K.submitMotivation(...e)),["prevent"])),class:"form-group"},[a[22]||(a[22]=(0,l.Lk)("label",null,"–ò–º—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞:",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":a[2]||(a[2]=e=>J.form.name=e),required:""},null,512),[[s.Jo,J.form.name]]),a[23]||(a[23]=(0,l.Lk)("label",null,"–î–æ–ª–∂–Ω–æ—Å—Ç—å:",-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":a[3]||(a[3]=e=>J.form.role=e),required:""},null,512),[[s.Jo,J.form.role]]),a[24]||(a[24]=(0,l.Lk)("label",null,"–ö–æ–º–∞–Ω–¥–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):",-1)),(0,l.bo)((0,l.Lk)("select",{"onUpdate:modelValue":a[4]||(a[4]=e=>J.form.team_id=e)},[a[21]||(a[21]=(0,l.Lk)("option",{value:""},"‚Äî –ë–µ–∑ –∫–æ–º–∞–Ω–¥—ã ‚Äî",-1)),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(J.teams,(e=>((0,l.uX)(),(0,l.CE)("option",{key:e.id,value:e.id},(0,o.v_)(e.name),9,E)))),128))],512),[[s.u1,J.form.team_id]]),a[25]||(a[25]=(0,l.Lk)("label",null,"1. –ü–æ–≤–µ–¥–µ–Ω–∏–µ –≤ —Å—Ç—Ä–µ—Å—Å–æ–≤–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏",-1)),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":a[5]||(a[5]=e=>J.form.stress=e),required:""},null,512),[[s.Jo,J.form.stress]]),a[26]||(a[26]=(0,l.Lk)("label",null,"2. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –¥—Ä—É–≥–∏–º–∏",-1)),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":a[6]||(a[6]=e=>J.form.communication=e),required:""},null,512),[[s.Jo,J.form.communication]]),a[27]||(a[27]=(0,l.Lk)("label",null,"3. –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤ —Ä–∞–±–æ—Ç–µ",-1)),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":a[7]||(a[7]=e=>J.form.behavior=e),required:""},null,512),[[s.Jo,J.form.behavior]]),a[28]||(a[28]=(0,l.Lk)("label",null,"4. –†–µ–∞–∫—Ü–∏–∏ –Ω–∞ –∫—Ä–∏—Ç–∏–∫—É –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è",-1)),(0,l.bo)((0,l.Lk)("textarea",{"onUpdate:modelValue":a[8]||(a[8]=e=>J.form.feedback=e),required:""},null,512),[[s.Jo,J.form.feedback]]),(0,l.Lk)("div",A,[(0,l.Lk)("button",{onClick:a[9]||(a[9]=e=>K.submitMotivation(!1)),disabled:J.loading}," üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å ",8,_),(0,l.Lk)("button",{onClick:a[10]||(a[10]=e=>K.submitMotivation(!0)),disabled:J.loading},[J.loading?((0,l.uX)(),(0,l.CE)("span",w,"‚è≥ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è...")):((0,l.uX)(),(0,l.CE)("span",x,"üí¨ –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏"))],8,M),(0,l.Lk)("button",{class:"modal-close",onClick:a[11]||(a[11]=e=>J.showModal=!1)},"‚úñ")])],32)])])):(0,l.Q3)("",!0),J.showAvatarModal?((0,l.uX)(),(0,l.CE)("div",I,[(0,l.Lk)("div",T,[a[31]||(a[31]=(0,l.Lk)("h2",null,"üé≠ –í—ã–±–æ—Ä –∞–≤–∞—Ç–∞—Ä–∞",-1)),(0,l.Lk)("div",S,[a[29]||(a[29]=(0,l.Lk)("h3",null,"üë® –ú—É–∂—Å–∫–∏–µ",-1)),(0,l.Lk)("div",X,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(J.avatars.male,(e=>((0,l.uX)(),(0,l.CE)("img",{key:e,src:`/avatars/${e}`,class:"avatar-option",onClick:a=>K.selectAvatar(e)},null,8,F)))),128))])]),(0,l.Lk)("div",D,[a[30]||(a[30]=(0,l.Lk)("h3",null,"üë© –ñ–µ–Ω—Å–∫–∏–µ",-1)),(0,l.Lk)("div",$,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(J.avatars.female,(e=>((0,l.uX)(),(0,l.CE)("img",{key:e,src:`/avatars/${e}`,class:"avatar-option",onClick:a=>K.selectAvatar(e)},null,8,U)))),128))])]),(0,l.Lk)("button",{class:"modal-close",onClick:a[13]||(a[13]=e=>J.showAvatarModal=!1)},"‚úñ")])])):(0,l.Q3)("",!0)],64)}t(4114),t(8111),t(2489),t(116),t(1701);var J={data(){return{form:{id:null,name:"",role:"",team_id:"",stress:"",communication:"",behavior:"",feedback:""},teams:[],employees:[],result:"",loading:!1,showModal:!1,showAvatarModal:!1,selectedEmployee:null,avatars:{male:["male1.png","male2.png","male3.png","male4.png","male5.png","male6.png"],female:["female1.png","female2.png","female3.png","female4.png","female5.png","female6.png"]},avatar:"default.png"}},async mounted(){const e=localStorage.getItem("token");try{const a=await fetch("/user_teams",{headers:{Authorization:`Bearer ${e}`}});this.teams=await a.json();const t=await fetch("/employees",{headers:{Authorization:`Bearer ${e}`}}),l=await t.json();if(!Array.isArray(l))return void console.error("–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –Ω–µ –ø–æ–ª—É—á–µ–Ω—ã:",l);this.employees=l.map((e=>({...e,motivators:this.extractFactors(e.ai_analysis,"–ú–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–µ"),demotivators:this.extractFactors(e.ai_analysis,"–î–µ–º–æ—Ç–∏–≤–∞—Ç–æ—Ä—ã"),managerTips:this.extractManagerTips(e.ai_analysis)})))}catch(a){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ:",a)}},methods:{async submitMotivation(e=!1){this.loading=!0;const a=localStorage.getItem("token"),t=e?"/motivation":"/employees",l="POST";try{const e=await fetch(t,{method:l,headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({...this.form,id:this.form.id,team_id:this.form.team_id||null})}),o=await e.json();if(e.ok){this.result=o.analysis||o.message,this.form.id=o.employee_id||o.id;const e={...this.form,id:this.form.id,ai_analysis:o.analysis||"",motivators:this.extractFactors(o.analysis,"–ú–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–µ"),demotivators:this.extractFactors(o.analysis,"–î–µ–º–æ—Ç–∏–≤–∞—Ç–æ—Ä—ã"),managerTips:this.extractManagerTips(o.analysis)},a=this.employees.findIndex((e=>e.id===this.form.id));-1!==a?this.employees.splice(a,1,e):this.employees.push(e),this.showModal=!1,setTimeout((()=>{location.reload()}),300)}else alert(o.error||"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è")}catch(o){console.error(o),alert("–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è")}finally{this.loading=!1}},resetForm(){this.form={id:null,name:"",role:"",team_id:"",stress:"",communication:"",behavior:"",feedback:""},this.result="",this.showModal=!0},async deleteEmployee(e){const a=localStorage.getItem("token");if(confirm("–£–¥–∞–ª–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞?"))try{await fetch(`/employee/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}}),this.employees=this.employees.filter((a=>a.id!==e))}catch(t){console.error("–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è",t)}},handleEmployeeClick(e){this.selectEmployee(e),this.showModal=!0},selectEmployee(e){this.form={...e},this.result=e.ai_analysis},extractDISCFullType(e){if(!e)return"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ";const a=e.match(/–¢–∏–ø DISC[:-]?\s*<\/?strong>?[\s"]*([A-Z–ê-–Ø]\s*\([^)]+?\))/i)||e.match(/–¢–∏–ø DISC[:-]?\s*([A-Z–ê-–Ø]\s*\([^)]+?\))/i);return a?a[1].trim():"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"},extractFactors(e,a){if(!e)return[];const t=document.createElement("div");t.innerHTML=e;const l=Array.from(t.querySelectorAll("h3, h4, strong")),o=l.find((e=>e.textContent.toLowerCase().includes(a.toLowerCase())));if(!o)return[];const s=o.nextElementSibling;return s&&"UL"===s.tagName?Array.from(s.querySelectorAll("li")).map((e=>e.textContent.trim())):[]},extractDISCType(e){if(!e)return"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ";const a=e.match(/–¢–∏–ø DISC[:-]?\s*<\/?strong>?[\s"]*([A-Z–ê-–Ø][^)<\n:]*\([A-Z–ê-–Ø]\))/i)||e.match(/—Ç–∏–ø\s+[A-Z–ê-–Ø]\s*\([^)]+\)/i)||e.match(/—Ç–∏–ø\s+["¬´]?(.)["¬ª]?/i);return a?a[1].trim():"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"},extractManagerTips(e){if(!e)return"";const a=e.match(/<h3>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è:.*?<\/ul>/is);return a?a[0]:""},getTeamName(e){const a=this.teams.find((a=>a.id===e));return a?a.name:"‚Äî"},getAvatarUrl(e){return`/avatars/${e.avatar||"default.png"}`},openAvatarModal(e){this.selectedEmployee=e,this.showAvatarModal=!0},async selectAvatar(e){if(!this.selectedEmployee)return;const a=localStorage.getItem("token");try{const t=await fetch("/employees",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({...this.selectedEmployee,avatar:e})});if(t.ok){const a=this.employees.findIndex((e=>e.id===this.selectedEmployee.id));-1!==a&&(this.employees[a].avatar=e),this.showAvatarModal=!1}}catch(t){console.error("Error updating avatar:",t)}},setDefaultAvatar(e){e.target.src="/avatars/default.png"}}},K=t(1241);const V=(0,K.A)(J,[["render",q],["__scopeId","data-v-09e5f228"]]);var j=V}}]);
//# sourceMappingURL=146.af968c6f.js.map