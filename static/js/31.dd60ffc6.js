"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[31],{8031:function(e,s,t){t.r(s),t.d(s,{default:function(){return G}});var a=t(6768),n=t(4232),r=t(5130);const l={class:"survey-results-container"},u={key:0,class:"loading"},i={key:1,class:"error"},o={key:2,class:"results-content"},c={class:"results-header"},v={class:"survey-meta"},d={class:"survey-type"},y={class:"response-count"},p={key:0,class:"enps-results"},k={class:"metrics-grid"},m={class:"metric-card nps-score"},h={class:"metric-value"},_={class:"metric-card response-count"},L={class:"metric-value"},C={class:"question-analytics"},g={class:"question-header"},b={class:"question-number"},E={class:"average-score"},X={class:"score-distribution"},w={class:"score-label"},f={key:1,class:"feedback-360-results"},x={class:"competency-results"},$={class:"competency-header"},R={class:"competency-name"},F={class:"competency-score"},I={class:"competency-bar"},D={class:"response-count"},S={key:0,class:"detailed-responses"},A={class:"toggle-anonymous"},K={class:"response-header"},Q={key:0,class:"respondent-name"},T={key:1,class:"respondent-anonymous"},q={class:"response-date"},U={class:"response-content"},N={key:0,class:"matrix-answer"},V={key:1,class:"text-answer"},j={class:"export-section"};function B(e,s,t,B,O,z){return(0,a.uX)(),(0,a.CE)("div",l,[O.loading?((0,a.uX)(),(0,a.CE)("div",u,"⏳ Загрузка результатов...")):O.error?((0,a.uX)(),(0,a.CE)("div",i,"❌ "+(0,n.v_)(O.error),1)):((0,a.uX)(),(0,a.CE)("div",o,[(0,a.Lk)("div",c,[(0,a.Lk)("h1",null,"📊 "+(0,n.v_)(O.survey.title),1),(0,a.Lk)("div",v,[(0,a.Lk)("span",d,(0,n.v_)(O.survey.survey_type.toUpperCase()),1),(0,a.Lk)("span",y,(0,n.v_)(e.$t("surveys.responses"))+": "+(0,n.v_)(O.survey.response_count),1)])]),"enps"===O.survey.survey_type?((0,a.uX)(),(0,a.CE)("div",p,[(0,a.Lk)("div",k,[(0,a.Lk)("div",m,[(0,a.Lk)("h3",null,(0,n.v_)(e.$t("surveys.npsScore")),1),(0,a.Lk)("div",h,(0,n.v_)(O.analytics.nps_score?.toFixed(1)||0),1)]),(0,a.Lk)("div",_,[(0,a.Lk)("h3",null,(0,n.v_)(e.$t("surveys.responseCount")),1),(0,a.Lk)("div",L,(0,n.v_)(O.analytics.response_count||0),1)])]),(0,a.Lk)("div",C,[s[2]||(s[2]=(0,a.Lk)("h3",null,"Средние оценки по вопросам",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(O.analytics.averages,((e,s)=>((0,a.uX)(),(0,a.CE)("div",{key:s,class:"question-result"},[(0,a.Lk)("div",g,[(0,a.Lk)("span",b,"Вопрос "+(0,n.v_)(s.replace("question_","")),1),(0,a.Lk)("span",E,(0,n.v_)(e.average.toFixed(2)),1)]),(0,a.Lk)("div",X,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.distribution,((s,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t,class:"distribution-bar",style:(0,n.Tr)({width:s/e.count*100+"%"})},[(0,a.Lk)("span",w,(0,n.v_)(t)+": "+(0,n.v_)(s),1)],4)))),128))])])))),128))])])):(0,a.Q3)("",!0),"360"===O.survey.survey_type?((0,a.uX)(),(0,a.CE)("div",f,[(0,a.Lk)("div",x,[(0,a.Lk)("h3",null,(0,n.v_)(e.$t("surveys.competencyRatings")),1),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(O.analytics.competency_averages,((e,s)=>((0,a.uX)(),(0,a.CE)("div",{key:s,class:"competency-item"},[(0,a.Lk)("div",$,[(0,a.Lk)("span",R,(0,n.v_)(s),1),(0,a.Lk)("span",F,(0,n.v_)(e.average.toFixed(2)),1)]),(0,a.Lk)("div",I,[(0,a.Lk)("div",{class:"bar-fill",style:(0,n.Tr)({width:e.average/5*100+"%"})},null,4)]),(0,a.Lk)("span",D,(0,n.v_)(e.count)+" "+(0,n.v_)(1===e.count?"ответ":"ответов"),1)])))),128))]),O.analytics.detailed_responses?((0,a.uX)(),(0,a.CE)("div",S,[(0,a.Lk)("h3",null,(0,n.v_)(e.$t("surveys.detailedView")),1),(0,a.Lk)("div",A,[(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=e=>O.showDetailedNames=e)},null,512),[[r.lH,O.showDetailedNames]]),s[3]||(s[3]=(0,a.eW)(" Показать имена респондентов (только для создателя) "))])]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(O.analytics.detailed_responses,((e,s)=>((0,a.uX)(),(0,a.CE)("div",{key:s,class:"response-card"},[(0,a.Lk)("div",K,[O.showDetailedNames?((0,a.uX)(),(0,a.CE)("span",Q,(0,n.v_)(e.respondent_name||"Анонимный"),1)):((0,a.uX)(),(0,a.CE)("span",T,"Респондент "+(0,n.v_)(s+1),1)),(0,a.Lk)("span",q,(0,n.v_)(z.formatDate(e.submitted_at)),1)]),(0,a.Lk)("div",U,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.answers,((e,s)=>((0,a.uX)(),(0,a.CE)("div",{key:s,class:"answer-item"},[(0,a.Lk)("strong",null,(0,n.v_)(z.getQuestionText(s))+":",1),"object"===typeof e?((0,a.uX)(),(0,a.CE)("div",N,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e,((e,s)=>((0,a.uX)(),(0,a.CE)("div",{key:s,class:"matrix-item"},(0,n.v_)(s)+": "+(0,n.v_)(e),1)))),128))])):((0,a.uX)(),(0,a.CE)("div",V,(0,n.v_)(e),1))])))),128))])])))),128))])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),(0,a.Lk)("div",j,[(0,a.Lk)("button",{onClick:s[1]||(s[1]=(...e)=>z.exportResults&&z.exportResults(...e)),class:"export-btn"}," 📄 "+(0,n.v_)(e.$t("surveys.exportResults")),1)])]))])}t(8111),t(7588),t(4603),t(7566),t(8721);var O=t(4373),z={name:"SurveyAnalytics",data(){return{survey:null,analytics:{},loading:!0,error:null,showDetailedNames:!1}},async mounted(){await this.loadResults()},methods:{async loadResults(){try{const e=this.$route.params.surveyId,s=localStorage.getItem("token"),t=await O.A.get(`/api/surveys/${e}/results`,{headers:{Authorization:`Bearer ${s}`}});this.survey=t.data.survey,this.analytics=t.data.analytics}catch(e){console.error("Error loading results:",e),this.error=e.response?.data?.error||"Ошибка загрузки результатов"}finally{this.loading=!1}},getQuestionText(e){const s={1:"Имя",2:"Ключевые таланты",3:"Области развития",4:"Примеры развития",5:"Другие комментарии",6:"Оценки компетенций"};return s[e]||`Вопрос ${e}`},formatDate(e){return new Date(e).toLocaleDateString("ru-RU",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},exportResults(){const e=this.generateCSV(),s=new Blob([e],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a"),a=URL.createObjectURL(s);t.setAttribute("href",a),t.setAttribute("download",`${this.survey.title}_results.csv`),t.style.visibility="hidden",document.body.appendChild(t),t.click(),document.body.removeChild(t)},generateCSV(){let e="Survey Results\n";return e+=`Title: ${this.survey.title}\n`,e+=`Type: ${this.survey.survey_type}\n`,e+=`Responses: ${this.survey.response_count}\n\n`,"enps"===this.survey.survey_type&&(e+="Question,Average Score,Response Count\n",Object.entries(this.analytics.averages||{}).forEach((([s,t])=>{e+=`${s},${t.average.toFixed(2)},${t.count}\n`}))),e}}},H=t(1241);const W=(0,H.A)(z,[["render",B],["__scopeId","data-v-24dd4610"]]);var G=W}}]);
//# sourceMappingURL=31.dd60ffc6.js.map