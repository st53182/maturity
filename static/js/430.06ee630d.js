"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[430],{5430:function(e,s,t){t.r(s),t.d(s,{default:function(){return R}});var o=t(6768),l=t(4232),a=t(5130);const n={class:"profile-page"},r={class:"form-section"},i=["placeholder"],p=["placeholder"],d=["placeholder"],c=["placeholder"],m={style:{color:"#666","font-size":"12px"}},u={class:"form-section"},f={type:"submit",class:"modern-button purple"},h={class:"disc-section"},k={class:"disc-actions"},y={key:0,class:"history-summary"},v={class:"history-list"},_={class:"history-header"},L={class:"history-type"},w={class:"history-date"},$=["onClick"],b={key:0,class:"recommendations-preview"},A=["innerHTML"],g={key:0,class:"latest-result"},P={class:"result-summary"},C={class:"personality-badge"},H={class:"scores"},U={class:"assessment-date"};function D(e,s,t,D,E,x){const I=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("div",n,[(0,o.Lk)("h1",null,(0,l.v_)(e.$t("profile.title")),1),(0,o.Lk)("form",{onSubmit:s[7]||(s[7]=(0,a.D$)(((...e)=>x.saveProfile&&x.saveProfile(...e)),["prevent"])),class:"profile-form"},[(0,o.Lk)("div",r,[(0,o.Lk)("h2",null,(0,l.v_)(e.$t("profile.generalInfo")),1),(0,o.Lk)("label",null,(0,l.v_)(e.$t("profile.username")),1),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>E.profile.name=e),placeholder:e.$t("profile.username")},null,8,i),[[a.Jo,E.profile.name]]),(0,o.Lk)("label",null,(0,l.v_)(e.$t("motivation.role")),1),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>E.profile.position=e),placeholder:e.$t("motivation.role")},null,8,p),[[a.Jo,E.profile.position]]),(0,o.Lk)("label",null,(0,l.v_)(e.$t("common.company")),1),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>E.profile.company=e),placeholder:e.$t("common.company")},null,8,d),[[a.Jo,E.profile.company]]),(0,o.Lk)("label",null,(0,l.v_)(e.$t("disc.personalityType")),1),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":s[3]||(s[3]=e=>E.profile.personality_type=e),placeholder:e.$t("disc.personalityType"),readonly:""},null,8,c),[[a.Jo,E.profile.personality_type]]),(0,o.Lk)("small",m,(0,l.v_)(e.$t("profile.autoDetected")),1)]),s[8]||(s[8]=(0,o.Lk)("hr",null,null,-1)),(0,o.Lk)("div",u,[(0,o.Lk)("h2",null,(0,l.v_)(e.$t("profile.changeCredentials")),1),(0,o.Lk)("label",null,(0,l.v_)(e.$t("profile.email")),1),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":s[4]||(s[4]=e=>E.profile.email=e),type:"email"},null,512),[[a.Jo,E.profile.email]]),(0,o.Lk)("label",null,(0,l.v_)(e.$t("profile.oldPassword")),1),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":s[5]||(s[5]=e=>E.oldPassword=e),type:"password"},null,512),[[a.Jo,E.oldPassword]]),(0,o.Lk)("label",null,(0,l.v_)(e.$t("profile.newPassword")),1),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":s[6]||(s[6]=e=>E.newPassword=e),type:"password"},null,512),[[a.Jo,E.newPassword]])]),(0,o.Lk)("button",f,(0,l.v_)(e.$t("profile.saveChanges")),1)],32),(0,o.Lk)("div",h,[(0,o.Lk)("h2",null,(0,l.v_)(e.$t("profile.discSection")),1),(0,o.Lk)("p",null,(0,l.v_)(e.$t("profile.discDescription")),1),(0,o.Lk)("div",k,[(0,o.bF)(I,{to:"/disc-assessment",class:"modern-button purple"},{default:(0,o.k6)((()=>[(0,o.eW)((0,l.v_)(E.profile.personality_type?e.$t("profile.retakeAssessment"):e.$t("profile.takeAssessment")),1)])),_:1}),E.assessmentHistory.length>0?((0,o.uX)(),(0,o.CE)("div",y,[(0,o.Lk)("h4",null,(0,l.v_)(e.$t("profile.completionHistory"))+" ("+(0,l.v_)(E.assessmentHistory.length)+")",1),(0,o.Lk)("div",v,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(E.assessmentHistory.slice(0,5),(s=>((0,o.uX)(),(0,o.CE)("div",{key:s.id,class:"history-item"},[(0,o.Lk)("div",_,[(0,o.Lk)("span",L,(0,l.v_)(s.personality_type),1),(0,o.Lk)("span",w,(0,l.v_)(x.formatDate(s.completed_at)),1),(0,o.Lk)("button",{onClick:e=>x.toggleRecommendations(s.id),class:"toggle-btn"},(0,l.v_)(E.expandedAssessments.includes(s.id)?"▼":"▶")+" "+(0,l.v_)(e.$t("profile.recommendations")),9,$)]),E.expandedAssessments.includes(s.id)?((0,o.uX)(),(0,o.CE)("div",b,[(0,o.Lk)("div",{class:"recommendations-content",innerHTML:x.formatRecommendations(s.recommendations)},null,8,A)])):(0,o.Q3)("",!0)])))),128))])])):(0,o.Q3)("",!0)]),E.latestAssessment?((0,o.uX)(),(0,o.CE)("div",g,[(0,o.Lk)("h3",null,(0,l.v_)(e.$t("profile.latestResult")),1),(0,o.Lk)("div",P,[(0,o.Lk)("div",C,(0,l.v_)(E.latestAssessment.personality_type),1),(0,o.Lk)("div",H,[(0,o.Lk)("span",null,"D: "+(0,l.v_)(E.latestAssessment.dominance_score),1),(0,o.Lk)("span",null,"I: "+(0,l.v_)(E.latestAssessment.influence_score),1),(0,o.Lk)("span",null,"S: "+(0,l.v_)(E.latestAssessment.steadiness_score),1),(0,o.Lk)("span",null,"C: "+(0,l.v_)(E.latestAssessment.conscientiousness_score),1)]),(0,o.Lk)("div",U,(0,l.v_)(x.formatDate(E.latestAssessment.completed_at)),1)])])):(0,o.Q3)("",!0)])])}t(4114);var E=t(4373),x={name:"UserProfile",data(){return{profile:{name:"",position:"",company:"",personality_type:"",email:""},oldPassword:"",newPassword:"",assessmentHistory:[],latestAssessment:null,expandedAssessments:[]}},async mounted(){try{const e=await E.A.get("/api/user_profile",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});this.profile=e.data,await this.fetchAssessmentHistory()}catch(e){console.error("Ошибка загрузки профиля:",e),alert(this.$t("profile.loadError"))}},methods:{async saveProfile(){try{await E.A.post("/api/update_profile",{...this.profile,old_password:this.oldPassword,new_password:this.newPassword},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),alert(this.$t("profile.profileUpdated")),this.oldPassword="",this.newPassword=""}catch(e){console.error("Ошибка сохранения:",e),alert(this.$t("profile.updateError"))}},async fetchAssessmentHistory(){try{const e=localStorage.getItem("token"),s=await E.A.get("/api/disc/history",{headers:{Authorization:`Bearer ${e}`}});s.data.success&&(this.assessmentHistory=s.data.assessments,this.latestAssessment=this.assessmentHistory[0]||null)}catch(e){console.error("Error fetching assessment history:",e)}},formatDate(e){const s=new Date(e);return s.toLocaleDateString("ru-RU",{year:"numeric",month:"short",day:"numeric"})},toggleRecommendations(e){const s=this.expandedAssessments.indexOf(e);s>-1?this.expandedAssessments.splice(s,1):this.expandedAssessments.push(e)},formatRecommendations(e){return e?e.replace(/\n/g,"<br>"):this.$t("profile.noRecommendations")}}},I=t(1241);const J=(0,I.A)(x,[["render",D],["__scopeId","data-v-7de9e6c5"]]);var R=J}}]);
//# sourceMappingURL=430.06ee630d.js.map