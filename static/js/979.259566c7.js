"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[979],{979:function(t,a,e){e.r(a),e.d(a,{default:function(){return P}});var o=e(6768),s=e(4232),n=e(5130);const i={class:"conflict-container"},l={class:"filter-bar"},c=["onClick"],r={class:"conflict-list"},p={key:0,class:"summary-block"},f=["innerHTML"],d=["onClick"],u=["onClick"],m={key:0,class:"modal-overlay"},h={class:"modal-content"},k=["innerHTML"],v={class:"modern-form"},g={class:"input-wrapper textarea-wrapper"},y={class:"floating-label"},C={class:"input-wrapper"},L=["value"],b={class:"floating-label"},_={class:"input-wrapper textarea-wrapper"},w={class:"floating-label"},$={class:"input-wrapper textarea-wrapper"},S={class:"floating-label"},x={class:"input-wrapper"},E={value:"–ê–∫—Ç–∏–≤–µ–Ω"},T={value:"–ó–∞–∫—Ä—ã—Ç"},I={value:"–û–±–æ—Å—Ç—Ä–µ–Ω–∏–µ"},A={class:"floating-label"},M={class:"modal-actions"},X=["disabled"],j=["disabled"];function J(t,a,e,J,N,O){return(0,o.uX)(),(0,o.CE)("div",i,[(0,o.Lk)("h1",null,(0,s.v_)(t.$t("conflicts.title")),1),(0,o.Lk)("div",l,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(N.statuses,(t=>((0,o.uX)(),(0,o.CE)("button",{key:t,class:(0,s.C4)({active:N.filterStatus===t}),onClick:a=>N.filterStatus=t},(0,s.v_)(t),11,c)))),128)),(0,o.Lk)("button",{onClick:a[0]||(a[0]=t=>O.openModal(null)),class:"add-btn"},"‚ûï "+(0,s.v_)(t.$t("conflicts.addConflict")),1)]),(0,o.Lk)("div",r,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(O.filteredConflicts,(t=>((0,o.uX)(),(0,o.CE)("div",{key:t.id,class:"conflict-card"},[(0,o.Lk)("h3",null,"üß† "+(0,s.v_)(t.context.slice(0,100))+"...",1),(0,o.Lk)("p",null,"üë• –£—á–∞—Å—Ç–Ω–∏–∫–∏: "+(0,s.v_)(O.getParticipantNames(t.participants)),1),(0,o.Lk)("p",null,"üéØ –¶–µ–ª—å: "+(0,s.v_)(t.goal),1),(0,o.Lk)("p",null,[a[9]||(a[9]=(0,o.eW)("üìå –°—Ç–∞—Ç—É—Å: ")),(0,o.Lk)("strong",null,(0,s.v_)(t.status),1)]),t.ai_analysis?((0,o.uX)(),(0,o.CE)("div",p,[a[10]||(a[10]=(0,o.Lk)("strong",null,"üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:",-1)),(0,o.Lk)("p",{innerHTML:O.shortenAnalysis(t.ai_analysis)},null,8,f)])):(0,o.Q3)("",!0),(0,o.Lk)("button",{onClick:a=>O.openModal(t)},"‚úèÔ∏è –û—Ç–∫—Ä—ã—Ç—å –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å ",8,d),(0,o.Lk)("button",{class:"delete-btn",onClick:a=>O.deleteConflict(t.id)},"üóë",8,u)])))),128))]),N.showModal?((0,o.uX)(),(0,o.CE)("div",m,[(0,o.Lk)("div",h,[N.form.ai_response?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"ai-analysis",innerHTML:N.form.ai_response},null,8,k)):(0,o.Q3)("",!0),(0,o.Lk)("h2",null,(0,s.v_)(N.form.id?t.$t("conflicts.editConflict"):t.$t("conflicts.addConflict")),1),(0,o.Lk)("div",v,[(0,o.Lk)("div",g,[a[11]||(a[11]=(0,o.Lk)("span",{class:"input-icon"},"üìù",-1)),(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":a[1]||(a[1]=t=>N.form.context=t),rows:"3",class:(0,s.C4)(["modern-input modern-textarea",{"has-value":N.form.context}])},null,2),[[n.Jo,N.form.context]]),(0,o.Lk)("label",y,(0,s.v_)(t.$t("conflicts.context")),1)]),(0,o.Lk)("div",C,[a[12]||(a[12]=(0,o.Lk)("span",{class:"input-icon"},"üë•",-1)),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":a[2]||(a[2]=t=>N.form.participants=t),multiple:"",class:(0,s.C4)(["modern-input modern-select",{"has-value":N.form.participants&&N.form.participants.length>0}])},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(N.employees,(t=>((0,o.uX)(),(0,o.CE)("option",{value:t.id,key:t.id},(0,s.v_)(t.name),9,L)))),128))],2),[[n.u1,N.form.participants]]),(0,o.Lk)("label",b,(0,s.v_)(t.$t("conflicts.participants")),1)]),(0,o.Lk)("div",_,[a[13]||(a[13]=(0,o.Lk)("span",{class:"input-icon"},"üîÑ",-1)),(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":a[3]||(a[3]=t=>N.form.actions_taken=t),rows:"3",class:(0,s.C4)(["modern-input modern-textarea",{"has-value":N.form.actions_taken}])},null,2),[[n.Jo,N.form.actions_taken]]),(0,o.Lk)("label",w,(0,s.v_)(t.$t("conflicts.actionsTaken")),1)]),(0,o.Lk)("div",$,[a[14]||(a[14]=(0,o.Lk)("span",{class:"input-icon"},"üéØ",-1)),(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":a[4]||(a[4]=t=>N.form.goal=t),rows:"3",class:(0,s.C4)(["modern-input modern-textarea",{"has-value":N.form.goal}])},null,2),[[n.Jo,N.form.goal]]),(0,o.Lk)("label",S,(0,s.v_)(t.$t("conflicts.goal")),1)]),(0,o.Lk)("div",x,[a[15]||(a[15]=(0,o.Lk)("span",{class:"input-icon"},"üìä",-1)),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":a[5]||(a[5]=t=>N.form.status=t),class:(0,s.C4)(["modern-input modern-select",{"has-value":N.form.status}])},[(0,o.Lk)("option",E,(0,s.v_)(t.$t("conflicts.active")),1),(0,o.Lk)("option",T,(0,s.v_)(t.$t("conflicts.resolved")),1),(0,o.Lk)("option",I,(0,s.v_)(t.$t("conflicts.active")),1)],2),[[n.u1,N.form.status]]),(0,o.Lk)("label",A,(0,s.v_)(t.$t("conflicts.status")),1)])]),(0,o.Lk)("div",M,[(0,o.Lk)("button",{class:"generate-btn",onClick:a[6]||(a[6]=(...t)=>O.submitConflict&&O.submitConflict(...t)),disabled:N.loading}," üí¨ "+(0,s.v_)(N.loading?t.$t("conflicts.analyzing"):t.$t("conflicts.analyze")),9,X),N.form.id?((0,o.uX)(),(0,o.CE)("button",{key:0,class:"save-btn",onClick:a[7]||(a[7]=(...t)=>O.saveConflict&&O.saveConflict(...t)),disabled:N.saving}," üíæ "+(0,s.v_)(N.saving?t.$t("common.loading"):t.$t("common.save")),9,j)):(0,o.Q3)("",!0),(0,o.Lk)("button",{class:"modal-close",onClick:a[8]||(a[8]=t=>N.showModal=!1)},"‚úñ")])])])):(0,o.Q3)("",!0)])}e(4114),e(8111),e(2489),e(1701);var N={data(){return{conflicts:[],employees:[],showModal:!1,saving:!1,loading:!1,filterStatus:"–í—Å–µ",statuses:["–í—Å–µ","–ê–∫—Ç–∏–≤–µ–Ω","–ó–∞–∫—Ä—ã—Ç","–û–±–æ—Å—Ç—Ä–µ–Ω–∏–µ"],form:{id:null,context:"",participants:[],actions_taken:"",goal:"",status:"–ê–∫—Ç–∏–≤–µ–Ω",ai_response:""}}},computed:{filteredConflicts(){return"–í—Å–µ"===this.filterStatus?this.conflicts:this.conflicts.filter((t=>t.status===this.filterStatus))}},methods:{async fetchConflicts(){const t=localStorage.getItem("token");try{const a=await fetch("/api/conflicts",{headers:{Authorization:`Bearer ${t}`}}),e=a.headers.get("content-type");if(!a.ok||!e?.includes("application/json"))return void console.error("–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤:",await a.text());this.conflicts=await a.json()}catch(a){console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤:",a)}},async fetchEmployees(){const t=localStorage.getItem("token");try{const a=await fetch("/employees",{headers:{Authorization:`Bearer ${t}`}}),e=a.headers.get("content-type");if(!a.ok||!e?.includes("application/json"))return void console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤:",await a.text());this.employees=await a.json()}catch(a){console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤:",a)}},shortenAnalysis(t){const a=t.replace(/<[^>]+>/g,"");return a.slice(0,350)+"..."},getParticipantNames(t){try{const a=Array.isArray(t)?t:JSON.parse(t);return this.employees.filter((t=>a.includes(t.id))).map((t=>t.name)).join(", ")}catch(a){return"‚Äî"}},openModal(t){if(t){this.form={...t};try{this.form.participants=JSON.parse(t.participants||"[]")}catch{this.form.participants=[]}this.form.ai_response=t.ai_analysis||"",this.form.actions_taken=t.attempts||""}else this.form={id:null,context:"",participants:[],actions_taken:"",goal:"",status:"–ê–∫—Ç–∏–≤–µ–Ω",ai_response:""};this.showModal=!0},async deleteConflict(t){const a=localStorage.getItem("token");try{await fetch(`/api/conflict/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}}),await this.fetchConflicts()}catch(e){alert("–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è"),console.error(e)}},async submitConflict(){this.loading=!0;const t=localStorage.getItem("token"),a={...this.form,participants:JSON.stringify(this.form.participants),attempts:this.form.actions_taken};delete a.actions_taken;const e=!!this.form.id,o=e?`/api/conflict/${this.form.id}`:"/api/conflicts",s=e?"PUT":"POST";try{const e=await fetch(o,{method:s,headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(a)}),n=await e.json();e.ok?(this.form.ai_response=n.analysis,await this.fetchConflicts()):alert(n.error||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞")}catch(n){console.error(n),alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏.")}finally{this.loading=!1}},async saveConflict(){this.saving=!0;const t=localStorage.getItem("token"),a={...this.form,participants:JSON.stringify(this.form.participants),attempts:this.form.actions_taken};delete a.actions_taken;try{const e=await fetch("/api/conflicts/save",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(a)}),o=await e.json();e.ok?(this.showModal=!1,await this.fetchConflicts()):alert(o.error||"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏")}catch(e){alert("–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è"),console.error(e)}finally{this.saving=!1}},async waitForTokenAndInit(){let t=10;while(!localStorage.getItem("token")&&t>0)await new Promise((t=>setTimeout(t,300))),t--;const a=localStorage.getItem("token");a?(await this.fetchConflicts(),await this.fetchEmployees()):this.$router.push("/login")}},mounted(){this.waitForTokenAndInit()}},O=e(1241);const z=(0,O.A)(N,[["render",J],["__scopeId","data-v-793eba2a"]]);var P=z}}]);
//# sourceMappingURL=979.259566c7.js.map