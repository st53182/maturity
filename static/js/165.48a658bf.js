"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[165],{2165:function(t,e,a){a.r(e),a.d(e,{default:function(){return N}});var o=a(6768),i=a(4232),l=a(5130);const n={class:"motivation-container"},s={class:"employee-list"},r=["onClick"],m=["src","onClick"],c={class:"card-header"},d={class:"employee-name"},u=["onClick"],v={class:"team-name"},h={class:"disc-type-full"},k={class:"employee-card-footer"},p=["onClick"],y={key:0,class:"factors"},f={class:"column"},g={class:"column"},L=["innerHTML"],C={key:0,class:"modal-overlay"},b={class:"modal-content"},_={value:""},$=["value"],E={class:"modal-actions"},A=["disabled"],w=["disabled"],M={key:0},S={key:1},x={key:1,class:"modal-overlay"},T={class:"modal-content avatar-modal"},I={class:"avatar-section"},X={class:"avatar-grid"},F=["src","onClick"],U={class:"avatar-section"},D={class:"avatar-grid"},q=["src","onClick"];function J(t,e,a,J,z,K){return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",n,[(0,o.Lk)("h1",null,(0,i.v_)(t.$t("motivation.title")),1),(0,o.Lk)("div",s,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(z.employees,(a=>((0,o.uX)(),(0,o.CE)("div",{key:a.id,class:"employee-card",onClick:t=>K.selectEmployee(a)},[(0,o.Lk)("img",{class:"avatar",src:K.getAvatarUrl(a),alt:"avatar",onClick:t=>K.openAvatarModal(a),onError:e[0]||(e[0]=(...t)=>K.setDefaultAvatar&&K.setDefaultAvatar(...t))},null,40,m),(0,o.Lk)("div",c,[(0,o.Lk)("h4",d,(0,i.v_)(a.name),1),(0,o.Lk)("button",{class:"delete-btn",onClick:(0,l.D$)((t=>K.deleteEmployee(a.id)),["stop"])},"üóë",8,u)]),(0,o.Lk)("p",v,[(0,o.eW)("üè¢ "+(0,i.v_)(t.$t("motivation.team"))+": ",1),(0,o.Lk)("strong",null,(0,i.v_)(K.getTeamName(a.team_id)||"‚Äî"),1)]),(0,o.Lk)("p",h,[(0,o.eW)("üß† "+(0,i.v_)(t.$t("disc.title"))+": ",1),(0,o.Lk)("strong",null,(0,i.v_)(K.extractDISCFullType(a.ai_analysis)),1)]),(0,o.Lk)("div",k,[(0,o.Lk)("button",{class:"update-btn",onClick:t=>K.handleEmployeeClick(a)}," üîÑ "+(0,i.v_)(t.$t("motivation.updateRecommendations")),9,p)]),a.ai_analysis?((0,o.uX)(),(0,o.CE)("div",y,[(0,o.Lk)("div",f,[(0,o.Lk)("h5",null,"‚¨ÜÔ∏è "+(0,i.v_)(t.$t("motivation.motivators")),1),(0,o.Lk)("ul",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.motivators,(t=>((0,o.uX)(),(0,o.CE)("li",{key:t},(0,i.v_)(t),1)))),128))])]),(0,o.Lk)("div",g,[(0,o.Lk)("h5",null,"‚¨áÔ∏è "+(0,i.v_)(t.$t("motivation.demotivators")),1),(0,o.Lk)("ul",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.demotivators,(t=>((0,o.uX)(),(0,o.CE)("li",{key:t},(0,i.v_)(t),1)))),128))])])])):(0,o.Q3)("",!0),a.ai_analysis?((0,o.uX)(),(0,o.CE)("div",{key:1,class:"manager-tips-block",innerHTML:K.extractManagerTips(a.ai_analysis)},null,8,L)):(0,o.Q3)("",!0),e[14]||(e[14]=(0,o.Lk)("div",{class:"form-footer"},null,-1))],8,r)))),128)),(0,o.Lk)("div",{class:"employee-card add-card",onClick:e[1]||(e[1]=(...t)=>K.resetForm&&K.resetForm(...t))},[e[15]||(e[15]=(0,o.Lk)("span",null,"‚ûï",-1)),(0,o.Lk)("p",null,(0,i.v_)(t.$t("motivation.addEmployee")),1)])])]),z.showModal?((0,o.uX)(),(0,o.CE)("div",C,[(0,o.Lk)("div",b,[(0,o.Lk)("form",{onSubmit:e[12]||(e[12]=(0,l.D$)(((...t)=>K.submitMotivation&&K.submitMotivation(...t)),["prevent"])),class:"form-group"},[(0,o.Lk)("label",null,(0,i.v_)(t.$t("motivation.employeeName"))+":",1),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>z.form.name=t),required:""},null,512),[[l.Jo,z.form.name]]),(0,o.Lk)("label",null,(0,i.v_)(t.$t("motivation.role"))+":",1),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>z.form.role=t),required:""},null,512),[[l.Jo,z.form.role]]),(0,o.Lk)("label",null,(0,i.v_)(t.$t("motivation.team"))+" ("+(0,i.v_)(t.$t("common.select"))+"):",1),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":e[4]||(e[4]=t=>z.form.team_id=t)},[(0,o.Lk)("option",_,"‚Äî "+(0,i.v_)(t.$t("motivation.noTeam"))+" ‚Äî",1),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(z.teams,(t=>((0,o.uX)(),(0,o.CE)("option",{key:t.id,value:t.id},(0,i.v_)(t.name),9,$)))),128))],512),[[l.u1,z.form.team_id]]),(0,o.Lk)("label",null,"1. "+(0,i.v_)(t.$t("motivation.stressFactors")),1),(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":e[5]||(e[5]=t=>z.form.stress=t),required:""},null,512),[[l.Jo,z.form.stress]]),(0,o.Lk)("label",null,"2. "+(0,i.v_)(t.$t("motivation.communicationStyle")),1),(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":e[6]||(e[6]=t=>z.form.communication=t),required:""},null,512),[[l.Jo,z.form.communication]]),(0,o.Lk)("label",null,"3. "+(0,i.v_)(t.$t("motivation.behaviorPatterns")),1),(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":e[7]||(e[7]=t=>z.form.behavior=t),required:""},null,512),[[l.Jo,z.form.behavior]]),(0,o.Lk)("label",null,"4. "+(0,i.v_)(t.$t("motivation.feedbackPreferences")),1),(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":e[8]||(e[8]=t=>z.form.feedback=t),required:""},null,512),[[l.Jo,z.form.feedback]]),(0,o.Lk)("div",E,[(0,o.Lk)("button",{onClick:e[9]||(e[9]=t=>K.submitMotivation(!1)),disabled:z.loading}," üíæ "+(0,i.v_)(t.$t("common.save")),9,A),(0,o.Lk)("button",{onClick:e[10]||(e[10]=t=>K.submitMotivation(!0)),disabled:z.loading},[z.loading?((0,o.uX)(),(0,o.CE)("span",M,"‚è≥ "+(0,i.v_)(t.$t("motivation.analyzing")),1)):((0,o.uX)(),(0,o.CE)("span",S,"üí¨ "+(0,i.v_)(t.$t("motivation.analyze")),1))],8,w),(0,o.Lk)("button",{class:"modal-close",onClick:e[11]||(e[11]=t=>z.showModal=!1)},"‚úñ")])],32)])])):(0,o.Q3)("",!0),z.showAvatarModal?((0,o.uX)(),(0,o.CE)("div",x,[(0,o.Lk)("div",T,[(0,o.Lk)("h2",null,"üé≠ "+(0,i.v_)(t.$t("motivation.avatarSelection")),1),(0,o.Lk)("div",I,[(0,o.Lk)("h3",null,"üë® "+(0,i.v_)(t.$t("motivation.maleAvatars")),1),(0,o.Lk)("div",X,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(z.avatars.male,(t=>((0,o.uX)(),(0,o.CE)("img",{key:t,src:`/avatars/${t}`,class:"avatar-option",onClick:e=>K.selectAvatar(t)},null,8,F)))),128))])]),(0,o.Lk)("div",U,[(0,o.Lk)("h3",null,"üë© "+(0,i.v_)(t.$t("motivation.femaleAvatars")),1),(0,o.Lk)("div",D,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(z.avatars.female,(t=>((0,o.uX)(),(0,o.CE)("img",{key:t,src:`/avatars/${t}`,class:"avatar-option",onClick:e=>K.selectAvatar(t)},null,8,q)))),128))])]),(0,o.Lk)("button",{class:"modal-close",onClick:e[13]||(e[13]=t=>z.showAvatarModal=!1)},"‚úñ")])])):(0,o.Q3)("",!0)],64)}a(4114),a(8111),a(2489),a(116),a(1701);var z={data(){return{form:{id:null,name:"",role:"",team_id:"",stress:"",communication:"",behavior:"",feedback:""},teams:[],employees:[],result:"",loading:!1,showModal:!1,showAvatarModal:!1,selectedEmployee:null,avatars:{male:["male1.png","male2.png","male3.png","male4.png","male5.png","male6.png"],female:["female1.png","female2.png","female3.png","female4.png","female5.png","female6.png"]},avatar:"default.png"}},async mounted(){const t=localStorage.getItem("token");try{const e=await fetch("/user_teams",{headers:{Authorization:`Bearer ${t}`}});this.teams=await e.json();const a=await fetch("/employees",{headers:{Authorization:`Bearer ${t}`}}),o=await a.json();if(!Array.isArray(o))return void console.error(this.$t("motivation.errorLoading")+":",o);this.employees=o.map((t=>({...t,motivators:this.extractFactors(t.ai_analysis,this.$t("motivation.motivators")),demotivators:this.extractFactors(t.ai_analysis,this.$t("motivation.demotivators")),managerTips:this.extractManagerTips(t.ai_analysis)})))}catch(e){console.error(this.$t("motivation.errorLoading")+":",e)}},methods:{async submitMotivation(t=!1){this.loading=!0;const e=localStorage.getItem("token"),a=t?"/motivation":"/employees",o="POST";try{const t=await fetch(a,{method:o,headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({...this.form,id:this.form.id,team_id:this.form.team_id||null})}),i=await t.json();if(t.ok){this.result=i.analysis||i.message,this.form.id=i.employee_id||i.id;const t={...this.form,id:this.form.id,ai_analysis:i.analysis||"",motivators:this.extractFactors(i.analysis,this.$t("motivation.motivators")),demotivators:this.extractFactors(i.analysis,this.$t("motivation.demotivators")),managerTips:this.extractManagerTips(i.analysis)},e=this.employees.findIndex((t=>t.id===this.form.id));-1!==e?this.employees.splice(e,1,t):this.employees.push(t),this.showModal=!1,setTimeout((()=>{location.reload()}),300)}else alert(i.error||this.$t("motivation.errorSaving"))}catch(i){console.error(i),alert(this.$t("conflicts.connectionError"))}finally{this.loading=!1}},resetForm(){this.form={id:null,name:"",role:"",team_id:"",stress:"",communication:"",behavior:"",feedback:""},this.result="",this.showModal=!0},async deleteEmployee(t){const e=localStorage.getItem("token");if(confirm(this.$t("motivation.confirmDelete")))try{await fetch(`/employee/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${e}`}}),this.employees=this.employees.filter((e=>e.id!==t))}catch(a){console.error(this.$t("motivation.errorSaving"),a)}},handleEmployeeClick(t){this.selectEmployee(t),this.showModal=!0},selectEmployee(t){this.form={...t},this.result=t.ai_analysis},extractDISCFullType(t){if(!t)return this.$t("common.unknown")||"Unknown";const e=t.match(/–¢–∏–ø DISC[:-]?\s*<\/?strong>?[\s"]*([A-Z–ê-–Ø]\s*\([^)]+?\))/i)||t.match(/–¢–∏–ø DISC[:-]?\s*([A-Z–ê-–Ø]\s*\([^)]+?\))/i);return e?e[1].trim():this.$t("common.unknown")||"Unknown"},extractFactors(t,e){if(!t)return[];const a=document.createElement("div");a.innerHTML=t;const o=Array.from(a.querySelectorAll("h3, h4, strong")),i=o.find((t=>t.textContent.toLowerCase().includes(e.toLowerCase())));if(!i)return[];const l=i.nextElementSibling;return l&&"UL"===l.tagName?Array.from(l.querySelectorAll("li")).map((t=>t.textContent.trim())):[]},extractDISCType(t){if(!t)return this.$t("common.unknown")||"Unknown";const e=t.match(/–¢–∏–ø DISC[:-]?\s*<\/?strong>?[\s"]*([A-Z–ê-–Ø][^)<\n:]*\([A-Z–ê-–Ø]\))/i)||t.match(/—Ç–∏–ø\s+[A-Z–ê-–Ø]\s*\([^)]+\)/i)||t.match(/—Ç–∏–ø\s+["¬´]?(.)["¬ª]?/i);return e?e[1].trim():this.$t("common.unknown")||"Unknown"},extractManagerTips(t){if(!t)return"";const e=t.match(/<h3>(?:–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è|Management Recommendations):.*?<\/ul>/is);return e?e[0]:""},getTeamName(t){const e=this.teams.find((e=>e.id===t));return e?e.name:"‚Äî"},getAvatarUrl(t){return`/avatars/${t.avatar||"default.png"}`},openAvatarModal(t){this.selectedEmployee=t,this.showAvatarModal=!0},async selectAvatar(t){if(!this.selectedEmployee)return;const e=localStorage.getItem("token");try{const a=await fetch("/employees",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({...this.selectedEmployee,avatar:t})});if(a.ok){const e=this.employees.findIndex((t=>t.id===this.selectedEmployee.id));-1!==e&&(this.employees[e].avatar=t),this.showAvatarModal=!1}}catch(a){console.error("Error updating avatar:",a)}},setDefaultAvatar(t){t.target.src="/avatars/default.png"}}},K=a(1241);const V=(0,K.A)(z,[["render",J],["__scopeId","data-v-1ddba8f2"]]);var N=V}}]);
//# sourceMappingURL=165.48a658bf.js.map