"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[254],{5254:function(e,s,r){r.r(s),r.d(s,{default:function(){return R}});var t=r(6768),n=r(4232),u=r(5130);const i={class:"take-survey-container"},a={key:0,class:"loading"},o={key:1,class:"error"},l={key:2,class:"success"},d={key:3,class:"survey-form"},c={class:"survey-header"},v={class:"survey-info"},y={class:"survey-type"},p={key:0,class:"deadline"},k={class:"progress-bar"},Q={class:"question-container"},h={key:0,class:"question"},m=["required"],w=["required"],b={key:2,class:"radio-options"},x=["value","required"],C={key:3,class:"scale-options"},E={class:"scale-buttons"},X=["onClick"],L={key:4,class:"matrix-rating"},q={class:"matrix-header"},f={class:"matrix-scale-labels"},g={class:"row-label"},I={class:"row-options"},A=["name","value","onUpdate:modelValue"],_={class:"navigation-buttons"},S=["disabled"],U=["disabled"];function $(e,s,r,$,F,K){return(0,t.uX)(),(0,t.CE)("div",i,[F.loading?((0,t.uX)(),(0,t.CE)("div",a,"⏳ Загрузка опросника...")):F.error?((0,t.uX)(),(0,t.CE)("div",o,"❌ "+(0,n.v_)(F.error),1)):F.submitted?((0,t.uX)(),(0,t.CE)("div",l,s[6]||(s[6]=[(0,t.Lk)("h2",null,"✅ Спасибо за участие!",-1),(0,t.Lk)("p",null,"Ваши ответы успешно отправлены.",-1)]))):((0,t.uX)(),(0,t.CE)("div",d,[(0,t.Lk)("div",c,[(0,t.Lk)("h1",null,(0,n.v_)(F.survey.title),1),(0,t.Lk)("div",v,[(0,t.Lk)("span",y,(0,n.v_)(F.survey.survey_type.toUpperCase()),1),F.survey.deadline?((0,t.uX)(),(0,t.CE)("span",p," Срок: "+(0,n.v_)(K.formatDate(F.survey.deadline)),1)):(0,t.Q3)("",!0)])]),(0,t.Lk)("div",k,[(0,t.Lk)("div",{class:"progress",style:(0,n.Tr)({width:K.progressPercent+"%"})},null,4)]),(0,t.Lk)("div",Q,[K.currentQuestion?((0,t.uX)(),(0,t.CE)("div",h,[(0,t.Lk)("h3",null,(0,n.v_)(K.currentQuestion.question),1),"text"===K.currentQuestion.type?(0,t.bo)(((0,t.uX)(),(0,t.CE)("input",{key:0,"onUpdate:modelValue":s[0]||(s[0]=e=>F.answers[K.currentQuestion.id]=e),type:"text",class:"text-input",required:K.currentQuestion.required},null,8,m)),[[u.Jo,F.answers[K.currentQuestion.id]]]):(0,t.Q3)("",!0),"textarea"===K.currentQuestion.type?(0,t.bo)(((0,t.uX)(),(0,t.CE)("textarea",{key:1,"onUpdate:modelValue":s[1]||(s[1]=e=>F.answers[K.currentQuestion.id]=e),class:"textarea-input",rows:"4",required:K.currentQuestion.required},null,8,w)),[[u.Jo,F.answers[K.currentQuestion.id]]]):(0,t.Q3)("",!0),"radio"===K.currentQuestion.type?((0,t.uX)(),(0,t.CE)("div",b,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(K.currentQuestion.options,(e=>((0,t.uX)(),(0,t.CE)("label",{key:e,class:"radio-label"},[(0,t.bo)((0,t.Lk)("input",{type:"radio",value:e,"onUpdate:modelValue":s[2]||(s[2]=e=>F.answers[K.currentQuestion.id]=e),required:K.currentQuestion.required},null,8,x),[[u.XL,F.answers[K.currentQuestion.id]]]),(0,t.Lk)("span",null,(0,n.v_)(e),1)])))),128))])):(0,t.Q3)("",!0),"scale"===K.currentQuestion.type?((0,t.uX)(),(0,t.CE)("div",C,[s[7]||(s[7]=(0,t.Lk)("div",{class:"scale-labels"},[(0,t.Lk)("span",null,"1 (Низко)"),(0,t.Lk)("span",null,"5 (Высоко)")],-1)),(0,t.Lk)("div",E,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(K.currentQuestion.scale,(e=>((0,t.uX)(),(0,t.CE)("button",{key:e,class:(0,n.C4)([{active:F.answers[K.currentQuestion.id]==e},"scale-btn"]),onClick:s=>F.answers[K.currentQuestion.id]=e},(0,n.v_)(e),11,X)))),128))])])):(0,t.Q3)("",!0),"matrix"===K.currentQuestion.type?((0,t.uX)(),(0,t.CE)("div",L,[(0,t.Lk)("div",q,[(0,t.Lk)("div",f,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(K.currentQuestion.scale,(e=>((0,t.uX)(),(0,t.CE)("span",{key:e,class:"scale-label"},(0,n.v_)(e),1)))),128))])]),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(K.currentQuestion.rows,(e=>((0,t.uX)(),(0,t.CE)("div",{key:e,class:"matrix-row"},[(0,t.Lk)("div",g,(0,n.v_)(e),1),(0,t.Lk)("div",I,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(K.currentQuestion.scale,((r,n)=>((0,t.uX)(),(0,t.CE)("label",{key:n,class:"matrix-option"},[(0,t.bo)((0,t.Lk)("input",{type:"radio",name:`matrix_${K.currentQuestion.id}_${e}`,value:r,"onUpdate:modelValue":s=>F.matrixAnswers[K.currentQuestion.id][e]=s},null,8,A),[[u.XL,F.matrixAnswers[K.currentQuestion.id][e]]]),s[8]||(s[8]=(0,t.Lk)("span",{class:"radio-custom"},null,-1))])))),128))])])))),128))])):(0,t.Q3)("",!0)])):(0,t.Q3)("",!0),(0,t.Lk)("div",_,[F.currentQuestionIndex>0?((0,t.uX)(),(0,t.CE)("button",{key:0,onClick:s[3]||(s[3]=(...e)=>K.previousQuestion&&K.previousQuestion(...e)),class:"nav-btn prev-btn"}," ← Назад ")):(0,t.Q3)("",!0),F.currentQuestionIndex<F.survey.questions.length-1?((0,t.uX)(),(0,t.CE)("button",{key:1,onClick:s[4]||(s[4]=(...e)=>K.nextQuestion&&K.nextQuestion(...e)),class:"nav-btn next-btn",disabled:!K.isCurrentQuestionAnswered}," Далее → ",8,S)):(0,t.Q3)("",!0),F.currentQuestionIndex===F.survey.questions.length-1?((0,t.uX)(),(0,t.CE)("button",{key:2,onClick:s[5]||(s[5]=(...e)=>K.submitSurvey&&K.submitSurvey(...e)),class:"nav-btn submit-btn",disabled:!K.allRequiredAnswered}," Отправить ответы ",8,U)):(0,t.Q3)("",!0)])])]))])}r(8111),r(1148),r(7588);var F=r(4373),K={name:"SurveyTaker",data(){return{survey:null,loading:!0,error:null,submitted:!1,currentQuestionIndex:0,answers:{},matrixAnswers:{}}},computed:{currentQuestion(){return this.survey?.questions[this.currentQuestionIndex]},progressPercent(){return this.survey?(this.currentQuestionIndex+1)/this.survey.questions.length*100:0},isCurrentQuestionAnswered(){const e=this.currentQuestion;if(!e)return!1;if("matrix"===e.type){const s=this.matrixAnswers[e.id]||{};return!e.required||e.rows.every((e=>s[e]))}return!e.required||void 0!==this.answers[e.id]&&""!==this.answers[e.id]},allRequiredAnswered(){return this.survey?.questions.every((e=>{if(!e.required)return!0;if("matrix"===e.type){const s=this.matrixAnswers[e.id]||{};return e.rows.every((e=>s[e]))}return void 0!==this.answers[e.id]&&""!==this.answers[e.id]}))}},async mounted(){await this.loadSurvey()},methods:{async loadSurvey(){try{const e=this.$route.params.token,s=await F.A.get(`/api/survey/${e}`);this.survey=s.data,this.survey.questions.forEach((e=>{"matrix"===e.type&&this.$set(this.matrixAnswers,e.id,{})}))}catch(e){console.error("Error loading survey:",e),this.error=e.response?.data?.error||"Ошибка загрузки опросника"}finally{this.loading=!1}},nextQuestion(){this.currentQuestionIndex<this.survey.questions.length-1&&this.currentQuestionIndex++},previousQuestion(){this.currentQuestionIndex>0&&this.currentQuestionIndex--},async submitSurvey(){try{const e=this.$route.params.token,s={...this.answers};Object.keys(this.matrixAnswers).forEach((e=>{s[e]=this.matrixAnswers[e]})),await F.A.post(`/api/survey/${e}/submit`,{answers:s,respondent_name:this.answers[1]}),this.submitted=!0}catch(e){console.error("Error submitting survey:",e),alert("Ошибка отправки ответов")}},formatDate(e){return new Date(e).toLocaleDateString("ru-RU")}}},V=r(1241);const D=(0,V.A)(K,[["render",$],["__scopeId","data-v-5d0233a9"]]);var R=D}}]);
//# sourceMappingURL=254.c118b5c9.js.map